const crypto=require("crypto"),_=require("lodash"),{TYPE,TRANSACTION_FAMILY_VERSION,TRANSACTION_FAMILY}=require("./utils/constants"),{logFormatted,SEVERITY}=require("./utils/logger"),{InvalidTransaction,InternalError}=require("sawtooth-sdk/processor/exceptions"),{inputValidation,postValidationChain}=require("./validators/cryptocurrency"),{postTransaction}=require("./controllers/cryptocurrency"),{postUser}=require("./controllers/users"),{PREFIX}=require("./controllers/common"),handlers={[TYPE.TRANSACTION]:{async post(r,t){logFormatted(`Handling post transaction with address ${t.address}`,SEVERITY.NOTIFY);try{await postValidationChain(r,t),await postTransaction(r,t)}catch(r){throw console.error(r),new InvalidTransaction(r)}},async put(r,t){logFormatted(`Handling put transaction with address ${t.address}`,SEVERITY.NOTIFY),await postTransaction(r,t)}},[TYPE.USER]:{async post(r,t){logFormatted(`Handling post user with address ${t.address}`,SEVERITY.NOTIFY),await postUser(r,t)},async put(r,t){logFormatted(`Handling put user with address ${t.address}`,SEVERITY.NOTIFY),await postUser(r,t)}}};module.exports={TP_FAMILY:TRANSACTION_FAMILY,TP_VERSION:TRANSACTION_FAMILY_VERSION,TP_NAMESPACE:PREFIX,handlers:handlers};