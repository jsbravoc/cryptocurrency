const _0x49f2=['sort','12FagklR','::\x20','__proto__','signerPubkey','sawtooth-sdk/processor','error','\x20isn\x27t\x20being\x20transferred','Cryptocurrency\x20can\x20only\x20be\x20transferred\x20by\x20its\x20owner','hex','UXxBT','66118BUbXvG','create','payload','owner','reject','Transaction\x20rejection\x20can\x20only\x20done\x20by\x20the\x20potential\x20new\x20owner','Action\x20must\x20be\x20\x22create\x22,\x20\x22transfer\x22,\x20\x22accept\x22,\x20or\x20\x22reject\x22','decode','apply','parse','set','qlWyU','transfer','slice','\x20does\x20not\x20exist','iaZxH','from','then','34yXyybV','length','jWzyx','328079tgnDqn','PLhWo','bind','resolve','199658XJRRmw','49223RbVcjt','toString','562776avoMsj','Initializing\x20JSON\x20handler\x20for\x20CNK-Cryptocurrency','155667XFiGLq','wxIby','crypto','console','get','exception','exports','\x20>\x20','422935bkPfCm','prototype','Cryptocurrency\x20with\x20address\x20','constructor','sawtooth-sdk/processor/exceptions','log','stringify','digest','Transaction\x20approval\x20can\x20only\x20done\x20by\x20the\x20potential\x20new\x20owner','warn','application/json'];const _0x460d=function(_0x2f991b,_0x33b429){_0x2f991b=_0x2f991b-0xc7;let _0x27f501=_0x49f2[_0x2f991b];return _0x27f501;};const _0x129475=_0x460d;(function(_0x5ebab1,_0x2bc3c3){const _0x41796f=_0x460d;while(!![]){try{const _0x4c631d=-parseInt(_0x41796f(0xce))+-parseInt(_0x41796f(0xd1))+-parseInt(_0x41796f(0xca))+-parseInt(_0x41796f(0xdb))+parseInt(_0x41796f(0xcf))*-parseInt(_0x41796f(0xe7))+parseInt(_0x41796f(0xd3))+parseInt(_0x41796f(0xf1))*parseInt(_0x41796f(0xc7));if(_0x4c631d===_0x2bc3c3)break;else _0x5ebab1['push'](_0x5ebab1['shift']());}catch(_0x4e79f9){_0x5ebab1['push'](_0x5ebab1['shift']());}}}(_0x49f2,0x49223));const _0x26359e=function(){let _0x171f48=!![];return function(_0x478471,_0xbbb69c){const _0x51c838=_0x171f48?function(){const _0x2cf8a2=_0x460d;if(_0x2cf8a2(0xc9)==='gGSpb'){function _0x3fbc26(){const _0x30c7f2=_0x2cf8a2,_0x5c2407=_0x11be16(_0x4a9e03);return _0x4c80ed[_0x30c7f2(0xd7)]([_0x5c2407])[_0x30c7f2(0x102)](_0x43dd09=>{const _0x2225d0=_0x30c7f2;_0x43dd09=_0x43dd09[_0x5c2407];if(!_0x43dd09||0x0===_0x43dd09[_0x2225d0(0xc8)])throw new _0x28206d(_0x2225d0(0xdd)+_0x5c2407+_0x2225d0(0xed));if(_0x4bb535!==_0x4bcaef(_0x43dd09)[_0x2225d0(0xf4)])throw new _0x15d1f6(_0x2225d0(0xe3));return _0x52b59f[_0x2225d0(0xfb)]({[_0x5c2407]:_0x81c77e(0x0),[_0x3ce5f4(_0xa8b1e1)]:_0x5ae876({'name':_0x57c450,'owner':_0x3c6766})});});}}else{if(_0xbbb69c){const _0x329d92=_0xbbb69c[_0x2cf8a2(0xf9)](_0x478471,arguments);return _0xbbb69c=null,_0x329d92;}}}:function(){};return _0x171f48=![],_0x51c838;};}(),_0x1243cc=_0x26359e(this,function(){const _0x2011f7=_0x460d;let _0x3aa251;try{const _0x3fcc52=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x3aa251=_0x3fcc52();}catch(_0x2db256){if(_0x2011f7(0xd4)!==_0x2011f7(0xf0))_0x3aa251=window;else{function _0x597006(){_0x11cdb4=_0x241a2b;}}}const _0x3a115f=_0x3aa251[_0x2011f7(0xd6)]=_0x3aa251[_0x2011f7(0xd6)]||{},_0xdf29dd=['log',_0x2011f7(0xe4),'info',_0x2011f7(0xec),_0x2011f7(0xd8),'table','trace'];for(let _0x1e7379=0x0;_0x1e7379<_0xdf29dd['length'];_0x1e7379++){if(_0x2011f7(0xcb)!==_0x2011f7(0xfc)){const _0x5d8e40=_0x26359e[_0x2011f7(0xde)][_0x2011f7(0xdc)][_0x2011f7(0xcc)](_0x26359e),_0x5d8194=_0xdf29dd[_0x1e7379],_0x464dc3=_0x3a115f[_0x5d8194]||_0x5d8e40;_0x5d8e40[_0x2011f7(0xe9)]=_0x26359e['bind'](_0x26359e),_0x5d8e40[_0x2011f7(0xd0)]=_0x464dc3[_0x2011f7(0xd0)]['bind'](_0x464dc3),_0x3a115f[_0x5d8194]=_0x5d8e40;}else{function _0x458b8e(){const _0x22cee6=_0x2011f7;_0x516bb8=_0x3d6d2c[_0x4d8a71];if(!_0x3c91c3||0x0===_0x5d6a64[_0x22cee6(0xc8)])throw new _0x350667(_0x22cee6(0xdd)+_0x322828+_0x22cee6(0xff));if(_0x3cc488!==_0x2b5ec6(_0x369c01)['owner'])throw new _0x119c83(_0x22cee6(0xee));return _0x197363[_0x22cee6(0xfb)]({[_0x1789e2]:_0x217c15({'asset':_0x39346f,'owner':_0x2c49e7})});}}}});_0x1243cc();'use strict';const {createHash}=require(_0x129475(0xd5)),{TransactionHandler}=require(_0x129475(0xeb)),{InvalidTransaction}=require(_0x129475(0xdf)),{TransactionHeader}=require('sawtooth-sdk/protobuf'),getAddress=(_0x1b141e,_0x326379=0x40)=>createHash('sha512')['update'](_0x1b141e)[_0x129475(0xe2)](_0x129475(0xef))[_0x129475(0xfe)](0x0,_0x326379),FAMILY='cnk-cryptocurrency',PREFIX=getAddress(FAMILY,0x6),getCryptocurrencyAddress=_0x1b17a2=>PREFIX+'00'+getAddress(_0x1b17a2,0x3e),getTransferAddress=_0x3dda12=>PREFIX+'01'+getAddress(_0x3dda12,0x3e),encode=_0x2e885f=>Buffer[_0x129475(0x101)](JSON[_0x129475(0xe1)](_0x2e885f,Object['keys'](_0x2e885f)[_0x129475(0xe6)]())),decode=_0x3c7515=>JSON[_0x129475(0xfa)](_0x3c7515[_0x129475(0xd0)]()),createCryptocurrency=(_0x12424b,_0x35396f,_0x5c7031)=>{const _0x35ac16=_0x129475,_0x3cd1c3=getCryptocurrencyAddress(_0x12424b);return _0x5c7031[_0x35ac16(0xd7)]([_0x3cd1c3])[_0x35ac16(0x102)](_0x115bc6=>{const _0x411b6e=_0x35ac16;if(_0x411b6e(0x100)===_0x411b6e(0x100)){_0x115bc6=_0x115bc6[_0x3cd1c3];if(_0x115bc6&&0x0<_0x115bc6['length'])throw new InvalidTransaction('Cryptocurrency\x20already\x20exists\x20with\x20the\x20address\x20'+_0x3cd1c3);return _0x5c7031[_0x411b6e(0xfb)]({[_0x3cd1c3]:encode({'name':_0x12424b,'owner':_0x35396f})});}else{function _0x4af35b(){const _0x4f551f=_0x411b6e,_0xa82d1a=_0x55b74d[_0x4f551f(0xf9)](_0x3113fe,arguments);return _0xd853cf=null,_0xa82d1a;}}});},transferCryptocurrency=(_0x4e277f,_0x772be0,_0x436347,_0x2e39e8)=>{const _0x5a954a=_0x129475,_0x2067c1=getTransferAddress(_0x4e277f),_0x47b96c=getCryptocurrencyAddress(_0x4e277f);return _0x2e39e8[_0x5a954a(0xd7)]([_0x47b96c])['then'](_0x3fa8e0=>{const _0x215186=_0x5a954a;_0x3fa8e0=_0x3fa8e0[_0x47b96c];if(!_0x3fa8e0||0x0===_0x3fa8e0[_0x215186(0xc8)])throw new InvalidTransaction('Cryptocurrency\x20with\x20address\x20'+_0x47b96c+'\x20does\x20not\x20exist');if(_0x436347!==decode(_0x3fa8e0)['owner'])throw new InvalidTransaction('Cryptocurrency\x20can\x20only\x20be\x20transferred\x20by\x20its\x20owner');return _0x2e39e8[_0x215186(0xfb)]({[_0x2067c1]:encode({'asset':_0x4e277f,'owner':_0x772be0})});});},acceptTransfer=(_0x2062a4,_0x411eb0,_0x505185)=>{const _0x4fce26=_0x129475,_0x15a6db=getTransferAddress(_0x2062a4);return _0x505185[_0x4fce26(0xd7)]([_0x15a6db])[_0x4fce26(0x102)](_0xfd6c83=>{const _0x9ebff6=_0x4fce26;_0xfd6c83=_0xfd6c83[_0x15a6db];if(!_0xfd6c83||0x0===_0xfd6c83[_0x9ebff6(0xc8)])throw new InvalidTransaction(_0x9ebff6(0xdd)+_0x15a6db+_0x9ebff6(0xed));if(_0x411eb0!==decode(_0xfd6c83)['owner'])throw new InvalidTransaction('Transaction\x20approval\x20can\x20only\x20done\x20by\x20the\x20potential\x20new\x20owner');return _0x505185[_0x9ebff6(0xfb)]({[_0x15a6db]:Buffer(0x0),[getCryptocurrencyAddress(_0x2062a4)]:encode({'name':_0x2062a4,'owner':_0x411eb0})});});},rejectTransfer=(_0x3e6c60,_0x1a6abf,_0x2ec771)=>{const _0x47996b=_0x129475,_0x477c5a=getTransferAddress(_0x3e6c60);return _0x2ec771[_0x47996b(0xd7)]([_0x477c5a])[_0x47996b(0x102)](_0x58525b=>{const _0x43163b=_0x47996b;_0x58525b=_0x58525b[_0x477c5a];if(!_0x58525b||0x0===_0x58525b['length'])throw new InvalidTransaction('Cryptocurrency\x20with\x20address\x20'+_0x477c5a+'\x20isn\x27t\x20being\x20transferred');if(_0x1a6abf!==decode(_0x58525b)[_0x43163b(0xf4)])throw new InvalidTransaction(_0x43163b(0xf6));return _0x2ec771[_0x43163b(0xfb)]({[_0x477c5a]:Buffer(0x0)});});};class JSONHandler extends TransactionHandler{constructor(){const _0x392c1a=_0x129475;console[_0x392c1a(0xe0)](_0x392c1a(0xd2)),super(FAMILY,'0.0',_0x392c1a(0xe5),[PREFIX]);}[_0x129475(0xf9)](_0x2ec58a,_0x50d785){const _0x2283df=_0x129475,_0xa2b939=TransactionHeader[_0x2283df(0xf8)](_0x2ec58a['header'])[_0x2283df(0xea)],{action:_0x4efece,owner:_0x18c78f}=JSON['parse'](_0x2ec58a[_0x2283df(0xf3)]);return console[_0x2283df(0xe0)]('Handling\x20transaction:\x20\x20'+_0x4efece+_0x2283df(0xda)+asset,_0x18c78f?'>\x20'+_0x18c78f['slice'](0x0,0x8)+'...\x20':'',_0x2283df(0xe8)+_0xa2b939[_0x2283df(0xfe)](0x0,0x8)+'...'),_0x2283df(0xf2)===_0x4efece?createCryptocurrency(asset,_0xa2b939,_0x50d785):_0x2283df(0xfd)===_0x4efece?transferCryptocurrency(asset,_0x18c78f,_0xa2b939,_0x50d785):'accept'===_0x4efece?acceptTransfer(asset,_0xa2b939,_0x50d785):_0x2283df(0xf5)===_0x4efece?rejectTransfer(asset,_0xa2b939,_0x50d785):Promise[_0x2283df(0xcd)]()[_0x2283df(0x102)](()=>{const _0x3faa24=_0x2283df;if('rMgxF'!=='kIOpw')throw new InvalidTransaction(_0x3faa24(0xf7));else{function _0x25e48a(){const _0x3aa0fd=_0x3faa24,_0x3b61bf=_0x5082e7(_0x1013db);return _0x520eac['get']([_0x3b61bf])[_0x3aa0fd(0x102)](_0x12c7a2=>{const _0x1bfb1a=_0x3aa0fd;_0x12c7a2=_0x12c7a2[_0x3b61bf];if(!_0x12c7a2||0x0===_0x12c7a2[_0x1bfb1a(0xc8)])throw new _0x27de31(_0x1bfb1a(0xdd)+_0x3b61bf+_0x1bfb1a(0xed));if(_0x51ed85!==_0x5aa913(_0x12c7a2)[_0x1bfb1a(0xf4)])throw new _0x4a86c('Transaction\x20rejection\x20can\x20only\x20done\x20by\x20the\x20potential\x20new\x20owner');return _0x4ab73a[_0x1bfb1a(0xfb)]({[_0x3b61bf]:_0x38c344(0x0)});});}}});}}module[_0x129475(0xd9)]={'JSONHandler':JSONHandler};