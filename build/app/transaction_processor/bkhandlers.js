const _0x3b5a=['...','owner','sha512','Cryptocurrency\x20can\x20only\x20be\x20transferred\x20by\x20its\x20owner','crypto','update','create','7gCEryM','log','header','apply','return\x20(function()\x20','table','reject','NicRr','set','get','0.0','209298DWxrOZ','parse','189519SDTWzo','from','console','exception','140935oArQxd','239429amVruj','bind','577655ZafmcW','resolve','then','application/json','keys','toString','signerPubkey','Cryptocurrency\x20with\x20address\x20','sawtooth-sdk/protobuf','hex','WrRmA','\x20does\x20not\x20exist','1KvZRpA','15672dWFiaO','digest','prototype','\x20isn\x27t\x20being\x20transferred','cnk-cryptocurrency','\x20>\x20','__proto__','Handling\x20transaction:\x20\x20','info','::\x20','{}.constructor(\x22return\x20this\x22)(\x20)','transfer','Action\x20must\x20be\x20\x22create\x22,\x20\x22transfer\x22,\x20\x22accept\x22,\x20or\x20\x22reject\x22','accept','slice','11heGlnj','Transaction\x20approval\x20can\x20only\x20done\x20by\x20the\x20potential\x20new\x20owner','length','25711MNtSmC','trace','stringify'];const _0x24c0=function(_0x152bcd,_0x198151){_0x152bcd=_0x152bcd-0x78;let _0x152aa2=_0x3b5a[_0x152bcd];return _0x152aa2;};const _0x195222=_0x24c0;(function(_0xc0c8bf,_0x8fc855){const _0x1860d1=_0x24c0;while(!![]){try{const _0x1b6e7b=parseInt(_0x1860d1(0x8b))+-parseInt(_0x1860d1(0xa9))*-parseInt(_0x1860d1(0x9a))+-parseInt(_0x1860d1(0x79))*-parseInt(_0x1860d1(0xac))+parseInt(_0x1860d1(0x84))+parseInt(_0x1860d1(0x8a))+-parseInt(_0x1860d1(0x86))+parseInt(_0x1860d1(0x8d))*-parseInt(_0x1860d1(0x99));if(_0x1b6e7b===_0x8fc855)break;else _0xc0c8bf['push'](_0xc0c8bf['shift']());}catch(_0x2faf7e){_0xc0c8bf['push'](_0xc0c8bf['shift']());}}}(_0x3b5a,0x2ab09));const _0x74fffc=function(){let _0x159c85=!![];return function(_0x44bc31,_0x59c66b){const _0x68e652=_0x159c85?function(){if(_0x59c66b){const _0x1949c5=_0x59c66b['apply'](_0x44bc31,arguments);return _0x59c66b=null,_0x1949c5;}}:function(){};return _0x159c85=![],_0x68e652;};}(),_0x29ee6f=_0x74fffc(this,function(){const _0x3270fc=_0x24c0,_0x15698e=function(){const _0x170af9=_0x24c0;let _0xa3f8d2;try{if(_0x170af9(0x80)===_0x170af9(0x80))_0xa3f8d2=Function(_0x170af9(0x7d)+_0x170af9(0xa4)+');')();else{function _0x1b4281(){const _0x33f4f3=_0x170af9;_0x4b05d7=_0x4cc198[_0x36f871];if(!_0x165fd8||0x0===_0x32c3dd[_0x33f4f3(0xab)])throw new _0x820430(_0x33f4f3(0x94)+_0x21bc1c+_0x33f4f3(0x98));if(_0x150446!==_0x32fb09(_0x48c487)[_0x33f4f3(0xb0)])throw new _0x1785e5(_0x33f4f3(0xb2));return _0x25de22[_0x33f4f3(0x81)]({[_0x5c150e]:_0xdda7c5({'asset':_0x595e76,'owner':_0x194542})});}}}catch(_0x516a67){_0xa3f8d2=window;}return _0xa3f8d2;},_0x57ef82=_0x15698e(),_0x249e17=_0x57ef82['console']=_0x57ef82[_0x3270fc(0x88)]||{},_0xae7c9a=['log','warn',_0x3270fc(0xa2),'error',_0x3270fc(0x89),_0x3270fc(0x7e),_0x3270fc(0xad)];for(let _0x13f3e5=0x0;_0x13f3e5<_0xae7c9a[_0x3270fc(0xab)];_0x13f3e5++){if(_0x3270fc(0x97)===_0x3270fc(0x97)){const _0x38a94a=_0x74fffc['constructor'][_0x3270fc(0x9c)]['bind'](_0x74fffc),_0x365f4f=_0xae7c9a[_0x13f3e5],_0x5179fc=_0x249e17[_0x365f4f]||_0x38a94a;_0x38a94a[_0x3270fc(0xa0)]=_0x74fffc[_0x3270fc(0x8c)](_0x74fffc),_0x38a94a['toString']=_0x5179fc[_0x3270fc(0x92)][_0x3270fc(0x8c)](_0x5179fc),_0x249e17[_0x365f4f]=_0x38a94a;}else{function _0x3d447e(){if(_0x17c95b){const _0x460913=_0x325385['apply'](_0x334876,arguments);return _0x2f1575=null,_0x460913;}}}}});_0x29ee6f();'use strict';const {createHash}=require(_0x195222(0xb3)),{TransactionHandler}=require('sawtooth-sdk/processor'),{InvalidTransaction}=require('sawtooth-sdk/processor/exceptions'),{TransactionHeader}=require(_0x195222(0x95)),getAddress=(_0x2e23fe,_0x4bb336=0x40)=>createHash(_0x195222(0xb1))[_0x195222(0xb4)](_0x2e23fe)[_0x195222(0x9b)](_0x195222(0x96))[_0x195222(0xa8)](0x0,_0x4bb336),FAMILY=_0x195222(0x9e),PREFIX=getAddress(FAMILY,0x6),getCryptocurrencyAddress=_0x565a81=>PREFIX+'00'+getAddress(_0x565a81,0x3e),getTransferAddress=_0x19bb9b=>PREFIX+'01'+getAddress(_0x19bb9b,0x3e),encode=_0x347d26=>Buffer[_0x195222(0x87)](JSON[_0x195222(0xae)](_0x347d26,Object[_0x195222(0x91)](_0x347d26)['sort']())),decode=_0x52c7ce=>JSON[_0x195222(0x85)](_0x52c7ce[_0x195222(0x92)]()),createCryptocurrency=(_0x1e74f2,_0x3f3964,_0x5f094f)=>{const _0x162cc9=_0x195222,_0x12ec06=getCryptocurrencyAddress(_0x1e74f2);return _0x5f094f[_0x162cc9(0x82)]([_0x12ec06])[_0x162cc9(0x8f)](_0x1cd92e=>{const _0x13321f=_0x162cc9;_0x1cd92e=_0x1cd92e[_0x12ec06];if(_0x1cd92e&&0x0<_0x1cd92e[_0x13321f(0xab)])throw new InvalidTransaction('Cryptocurrency\x20already\x20exists\x20with\x20the\x20address\x20'+_0x12ec06);return _0x5f094f['set']({[_0x12ec06]:encode({'name':_0x1e74f2,'owner':_0x3f3964})});});},transferCryptocurrency=(_0xfc2d1,_0x2de6b7,_0x5797aa,_0x29156e)=>{const _0x47010f=_0x195222,_0x39810f=getTransferAddress(_0xfc2d1),_0x5d44d4=getCryptocurrencyAddress(_0xfc2d1);return _0x29156e[_0x47010f(0x82)]([_0x5d44d4])[_0x47010f(0x8f)](_0x308f81=>{const _0x2ec989=_0x47010f;_0x308f81=_0x308f81[_0x5d44d4];if(!_0x308f81||0x0===_0x308f81['length'])throw new InvalidTransaction(_0x2ec989(0x94)+_0x5d44d4+_0x2ec989(0x98));if(_0x5797aa!==decode(_0x308f81)[_0x2ec989(0xb0)])throw new InvalidTransaction(_0x2ec989(0xb2));return _0x29156e['set']({[_0x39810f]:encode({'asset':_0xfc2d1,'owner':_0x2de6b7})});});},acceptTransfer=(_0x54745e,_0x4912ea,_0x17e73e)=>{const _0xe93cf0=_0x195222,_0x22ee9e=getTransferAddress(_0x54745e);return _0x17e73e[_0xe93cf0(0x82)]([_0x22ee9e])[_0xe93cf0(0x8f)](_0x37a3d8=>{const _0xb55c0a=_0xe93cf0;_0x37a3d8=_0x37a3d8[_0x22ee9e];if(!_0x37a3d8||0x0===_0x37a3d8['length'])throw new InvalidTransaction(_0xb55c0a(0x94)+_0x22ee9e+'\x20isn\x27t\x20being\x20transferred');if(_0x4912ea!==decode(_0x37a3d8)[_0xb55c0a(0xb0)])throw new InvalidTransaction(_0xb55c0a(0xaa));return _0x17e73e[_0xb55c0a(0x81)]({[_0x22ee9e]:Buffer(0x0),[getCryptocurrencyAddress(_0x54745e)]:encode({'name':_0x54745e,'owner':_0x4912ea})});});},rejectTransfer=(_0x34e73e,_0x4e02ac,_0x532ccc)=>{const _0x102e56=_0x195222,_0x456815=getTransferAddress(_0x34e73e);return _0x532ccc[_0x102e56(0x82)]([_0x456815])['then'](_0x5dcb21=>{const _0x5f5b05=_0x102e56;_0x5dcb21=_0x5dcb21[_0x456815];if(!_0x5dcb21||0x0===_0x5dcb21[_0x5f5b05(0xab)])throw new InvalidTransaction(_0x5f5b05(0x94)+_0x456815+_0x5f5b05(0x9d));if(_0x4e02ac!==decode(_0x5dcb21)['owner'])throw new InvalidTransaction('Transaction\x20rejection\x20can\x20only\x20done\x20by\x20the\x20potential\x20new\x20owner');return _0x532ccc[_0x5f5b05(0x81)]({[_0x456815]:Buffer(0x0)});});};class JSONHandler extends TransactionHandler{constructor(){const _0x291abd=_0x195222;console[_0x291abd(0x7a)]('Initializing\x20JSON\x20handler\x20for\x20CNK-Cryptocurrency'),super(FAMILY,_0x291abd(0x83),_0x291abd(0x90),[PREFIX]);}[_0x195222(0x7c)](_0xe36162,_0x26c6f9){const _0x3e16e8=_0x195222,_0x3bc8aa=TransactionHeader['decode'](_0xe36162[_0x3e16e8(0x7b)])[_0x3e16e8(0x93)],{action:_0x4fcd6c,owner:_0x3f858f}=JSON['parse'](_0xe36162['payload']);return console[_0x3e16e8(0x7a)](_0x3e16e8(0xa1)+_0x4fcd6c+_0x3e16e8(0x9f)+asset,_0x3f858f?'>\x20'+_0x3f858f[_0x3e16e8(0xa8)](0x0,0x8)+'...\x20':'',_0x3e16e8(0xa3)+_0x3bc8aa[_0x3e16e8(0xa8)](0x0,0x8)+_0x3e16e8(0xaf)),_0x3e16e8(0x78)===_0x4fcd6c?createCryptocurrency(asset,_0x3bc8aa,_0x26c6f9):_0x3e16e8(0xa5)===_0x4fcd6c?transferCryptocurrency(asset,_0x3f858f,_0x3bc8aa,_0x26c6f9):_0x3e16e8(0xa7)===_0x4fcd6c?acceptTransfer(asset,_0x3bc8aa,_0x26c6f9):_0x3e16e8(0x7f)===_0x4fcd6c?rejectTransfer(asset,_0x3bc8aa,_0x26c6f9):Promise[_0x3e16e8(0x8e)]()[_0x3e16e8(0x8f)](()=>{const _0x8bf174=_0x3e16e8;throw new InvalidTransaction(_0x8bf174(0xa6));});}}module['exports']={'JSONHandler':JSONHandler};