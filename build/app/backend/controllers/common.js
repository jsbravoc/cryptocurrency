const _0x41a0=['287059UZJzVN','ERROR','UrOFr','findAllAssets','map','YFKVk','length','TRANSACTION','TRANSFER','\x20|\x20Querying\x20all\x20','\x0a\x20\x20\x20\x20','../utils/logger','TRANSACTION_FAMILY','Transaction','SAWTOOTH_REST','putAsset','\x20-\x20','SUCCESS','updated','KVFiS','prototype','exports','value','json','__proto__','getUserAddress','created','get','underscore','apply','crypto','\x20doesn\x27t\x20exist','log','info','base64','trace','warn','User','COpMd','exception','\x20|\x20Error\x20at\x20','parse','statusText','table','getTransferAddress','return\x20(function()\x20','&limit=20','bind','expectExisting','stack','callee','toHash','replace','hash512','update','1JhzxAi','console','221144kpQByF','transaction','GHaUE','USER','flatten','createHash','\x20|\x20BATCH\x20Response:\x20','isEmpty','Transfer','data','{}.constructor(\x22return\x20this\x22)(\x20)','1rdWZGA','from','find','3VarRSH','../models/User','../models/Transaction','1sPuYFg','address','POST','env','\x20\x20|\x20BATCH\x20Response:\x20','166417NkrfEm','IAXNs','659014nlOqrO','\x20with\x20address\x20','findByAddress','cnk-cryptocurrency','../sawtooth/sawtooth-helpers','s\x20-\x20','1.0','hex','163283RThWdA','status','19PgInPV','toString','constructor','1sjRveB','toLowerCase','digest','axios','TRANSACTION_FAMILY_VERSION','qBBmF','error','522750oGPBhT','application/json','ovXdT','body','7284bkYLqf','sha512','http://localhost:8008'];const _0x231f=function(_0x90afab,_0x34c0e2){_0x90afab=_0x90afab-0xf6;let _0x1720c6=_0x41a0[_0x90afab];return _0x1720c6;};const _0x58fc0c=_0x231f;(function(_0x23a993,_0x2b87a4){const _0x2a3d81=_0x231f;while(!![]){try{const _0x4da2c0=-parseInt(_0x2a3d81(0x15a))*parseInt(_0x2a3d81(0x155))+-parseInt(_0x2a3d81(0x157))*parseInt(_0x2a3d81(0xf9))+-parseInt(_0x2a3d81(0x161))+parseInt(_0x2a3d81(0x133))*-parseInt(_0x2a3d81(0xfc))+-parseInt(_0x2a3d81(0x143))*-parseInt(_0x2a3d81(0x14b))+-parseInt(_0x2a3d81(0x140))*-parseInt(_0x2a3d81(0x135))+-parseInt(_0x2a3d81(0x146))*-parseInt(_0x2a3d81(0x14d));if(_0x4da2c0===_0x2b87a4)break;else _0x23a993['push'](_0x23a993['shift']());}catch(_0x34766f){_0x23a993['push'](_0x23a993['shift']());}}}(_0x41a0,0x41691));const _0x5c5168=function(){let _0x3e88cc=!![];return function(_0x1c925a,_0x17075e){const _0x44d277=_0x3e88cc?function(){const _0x591550=_0x231f;if('PKlyC'!==_0x591550(0x14c)){if(_0x17075e){const _0x7b78e5=_0x17075e[_0x591550(0x119)](_0x1c925a,arguments);return _0x17075e=null,_0x7b78e5;}}else{function _0x3e0a8c(){const _0x528322=_0x591550,_0x5d370d=_0x39e11b[_0x528322(0x159)][_0x528322(0x110)][_0x528322(0x12b)](_0x3b5453),_0x24d93d=_0x2410b7[_0xc5ccb0],_0x96936e=_0x5afeea[_0x24d93d]||_0x5d370d;_0x5d370d[_0x528322(0x114)]=_0x336be1['bind'](_0x2100f5),_0x5d370d[_0x528322(0x158)]=_0x96936e['toString']['bind'](_0x96936e),_0x1782b5[_0x24d93d]=_0x5d370d;}}}:function(){};return _0x3e88cc=![],_0x44d277;};}(),_0x2f9ee7=_0x5c5168(this,function(){const _0x13028e=_0x231f;let _0x39da8d;try{if(_0x13028e(0x122)==='CTRfw'){function _0x4d04b2(){const _0x1c35a8=_0x13028e;if(_0x2095b6){const _0x208ae1=_0x461106[_0x1c35a8(0x119)](_0xf69cea,arguments);return _0xbeda4d=null,_0x208ae1;}}}else{const _0x2bfbe0=Function(_0x13028e(0x129)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x39da8d=_0x2bfbe0();}}catch(_0x132711){if(_0x13028e(0x137)===_0x13028e(0x137))_0x39da8d=window;else{function _0x165acb(){const _0x26e899=_0x13028e;var _0x119515=new _0x280de7()[_0x26e899(0x12d)][_0x26e899(0x130)](_0x26e899(0x106),'\x20'),_0x423db5=_0x2e503e+_0x26e899(0x14e)+_0xc01219+_0x26e899(0x11b);throw _0x56d5cf(_0x3b1e91+_0x26e899(0x124)+arguments[_0x26e899(0x12e)][_0x26e899(0x158)]()+_0x26e899(0x10c)+_0x423db5,_0xacae4['ERROR']),_0x1fb88f[_0x26e899(0x156)](0x194)[_0x26e899(0x113)]({'error':_0x423db5,'function':''+arguments[_0x26e899(0x12e)][_0x26e899(0x158)](),'parameters':[_0x2fa856?{'txid':_0x5c8d90,'transaction':_0x4b1ea4}:{'txid':_0x424ef9}],'stackTrace':_0x119515}),new _0x39702d(_0x423db5);}}}const _0x28df8c=_0x39da8d[_0x13028e(0x134)]=_0x39da8d['console']||{},_0x163b2f=[_0x13028e(0x11c),_0x13028e(0x120),_0x13028e(0x11d),_0x13028e(0x160),_0x13028e(0x123),_0x13028e(0x127),_0x13028e(0x11f)];for(let _0x5f5700=0x0;_0x5f5700<_0x163b2f['length'];_0x5f5700++){if(_0x13028e(0x101)===_0x13028e(0x101)){const _0x526211=_0x5c5168['constructor']['prototype'][_0x13028e(0x12b)](_0x5c5168),_0x375306=_0x163b2f[_0x5f5700],_0x335107=_0x28df8c[_0x375306]||_0x526211;_0x526211[_0x13028e(0x114)]=_0x5c5168[_0x13028e(0x12b)](_0x5c5168),_0x526211[_0x13028e(0x158)]=_0x335107['toString']['bind'](_0x335107),_0x28df8c[_0x375306]=_0x526211;}else{function _0x1f6f16(){const _0xbf5090=_0x13028e,_0x5791b1=_0x85db34(_0xbf5090(0x129)+_0xbf5090(0x13f)+');');_0x24060c=_0x5791b1();}}}});_0x2f9ee7();const _=require(_0x58fc0c(0x118)),crypto=require(_0x58fc0c(0x11a)),{default:axios}=require(_0x58fc0c(0x15d)),{TYPE,ADDRESS_PREFIX,HTTP_METHODS}=require('../utils/constants'),{logFormatted,SEVERITY}=require(_0x58fc0c(0x107)),TRANSACTION_FAMILY=_0x58fc0c(0x150),TRANSACTION_FAMILY_VERSION=_0x58fc0c(0x153),{queryState,sendTransaction}=require(_0x58fc0c(0x151)),Transaction=require(_0x58fc0c(0x145)),User=require(_0x58fc0c(0x144)),Transfer=require('../models/Transfer'),hash512=_0x4c49a6=>crypto[_0x58fc0c(0x13a)](_0x58fc0c(0xfa))[_0x58fc0c(0x132)](_0x4c49a6)[_0x58fc0c(0x15c)](_0x58fc0c(0x154)),getAddress=(_0x12b668,_0x136a53=0x40)=>hash512(_0x12b668)['slice'](0x0,_0x136a53),PREFIX=getAddress(TRANSACTION_FAMILY,0x6),getTransactionAddress=_0x551a63=>PREFIX+ADDRESS_PREFIX['TRANSACTION']+getAddress(_0x551a63,0x3e),getUserAddress=_0x359857=>PREFIX+ADDRESS_PREFIX[_0x58fc0c(0x138)]+getAddress(_0x359857,0x3e),getTransferAddress=_0x508f2d=>PREFIX+ADDRESS_PREFIX[_0x58fc0c(0x104)]+getAddress(_0x508f2d,0x3e),findByAddress=async(_0x5cf5d0,_0x525f4a)=>{const _0x230ae8=_0x58fc0c;let _0x3fc565;switch(_0x5cf5d0){case TYPE[_0x230ae8(0x103)]:_0x3fc565=getTransactionAddress(_0x525f4a);break;case TYPE[_0x230ae8(0x138)]:_0x3fc565=getUserAddress(_0x525f4a);break;default:return null;}let _0x21f328;return _0x21f328=await queryState(_0x3fc565),_0x21f328?(Array['isArray'](_0x21f328)&&(_0x21f328=_0x21f328[_0x230ae8(0x142)](_0x30547f=>_0x30547f[_0x230ae8(0x147)]===address)),_0x21f328):null;},expectExisting=async(_0xceec6d,_0x5e8014,_0x311a15,_0x3ed91d,_0x285022,_0x44d340)=>{const _0x5ecc9a=_0x58fc0c;let _0x14e8ab;switch(_0xceec6d){case TYPE[_0x5ecc9a(0x103)]:_0x14e8ab=_0x5ecc9a(0x109);break;case TYPE[_0x5ecc9a(0x138)]:_0x14e8ab=_0x5ecc9a(0x121);case TYPE[_0x5ecc9a(0x104)]:_0x14e8ab=_0x5ecc9a(0x13d);}var _0x1d1077=await this[_0x5ecc9a(0x14f)](_0xceec6d,_0x5e8014);if(_0x3ed91d&&!_0x1d1077){var _0x3db881=new Error()['stack'][_0x5ecc9a(0x130)](_0x5ecc9a(0x106),'\x20'),_0xceec6d=_0x14e8ab+'\x20with\x20address\x20'+_0x5e8014+_0x5ecc9a(0x11b);throw logFormatted(_0x285022+'\x20|\x20Error\x20at\x20'+arguments['callee'][_0x5ecc9a(0x158)]()+'\x20-\x20'+_0xceec6d,SEVERITY[_0x5ecc9a(0xfd)]),_0x44d340[_0x5ecc9a(0x156)](0x194)[_0x5ecc9a(0x113)]({'error':_0xceec6d,'function':''+arguments['callee'][_0x5ecc9a(0x158)](),'parameters':[_0x311a15?{'txid':_0x5e8014,'transaction':_0x311a15}:{'txid':_0x5e8014}],'stackTrace':_0x3db881}),new Error(_0xceec6d);}if(_0x3ed91d||!_0x1d1077)return _0x1d1077;_0x3ed91d=new Error()[_0x5ecc9a(0x12d)][_0x5ecc9a(0x130)](_0x5ecc9a(0x106),'\x20'),_0x1d1077=_0x14e8ab+_0x5ecc9a(0x14e)+_0x5e8014+'\x20already\x20exists';throw logFormatted(_0x285022+_0x5ecc9a(0x124)+arguments[_0x5ecc9a(0x12e)][_0x5ecc9a(0x158)]()+'\x20-\x20'+_0x1d1077,SEVERITY[_0x5ecc9a(0xfd)]),_0x44d340[_0x5ecc9a(0x156)](0x194)['json']({'error':_0x1d1077,'function':''+arguments[_0x5ecc9a(0x12e)][_0x5ecc9a(0x158)](),'parameters':[{'txid':_0x5e8014,'transaction':_0x311a15}],'stackTrace':_0x3ed91d}),new Error(_0x1d1077);},putAsset=async(_0x11dc54,_0xba42a6,_0x3623c6,_0x6f8b41,_0x22a3c6)=>{const _0xe38671=_0x58fc0c;let _0x58d22f,_0x490c1b,_0xe8f29d,_0x34b822;var _0x4d703a,{description:_0x34aa33}=_0x6f8b41[_0xe38671(0xf8)],{signature:_0x203dcd}=_0x6f8b41['body'];switch(_0x11dc54){case TYPE[_0xe38671(0x103)]:_0x34b822=_0xe38671(0x109);var {amount:_0x5d0499,recipient:_0x5aabd5,sender:_0x435ee6,valid:_0x305505,valid_thru:_0x4bc8d5}=_0x6f8b41['body'];_0x490c1b=_0x203dcd,_0x58d22f=new Transaction(_0x5d0499,_0x5aabd5,_0x435ee6,_0x34aa33,_0x305505,_0x4bc8d5,_0x203dcd)[_0xe38671(0x158)](!0x1,!0x1),_0xe8f29d=getTransactionAddress(_0x490c1b);break;case TYPE['USER']:_0x34b822=_0xe38671(0x121);const _0x3151e7=new User(_0x6f8b41[_0xe38671(0xf8)]);_0x490c1b=_0x3151e7[_0xe38671(0x147)],_0x58d22f=_0x3151e7[_0xe38671(0x158)](!0x0,!0x1),_0xe8f29d=getUserAddress(_0x490c1b);break;case TYPE[_0xe38671(0x104)]:_0x34b822=_0xe38671(0x13d);const _0x540256=new Transfer(_0x6f8b41['body']);_0x490c1b=_0x540256[_0xe38671(0x12f)](),_0x58d22f=_0x540256[_0xe38671(0x158)](!0x0,!0x1),_0xe8f29d=getTransferAddress(_0x490c1b);}try{await expectExisting(_0x11dc54,_0x490c1b,_0x58d22f,_0xba42a6!==HTTP_METHODS[_0xe38671(0x148)],_0x3623c6,_0x22a3c6);}catch(_0x2e39d2){if(_0xe38671(0xf7)===_0xe38671(0xfe)){function _0x57e0ce(){const _0x399791=_0xe38671;let _0x576ea9=_0xb2a8e4[_0x399791(0x125)](_0x4a14a5[_0x399791(0x141)](_0x1812a3[_0x399791(0x13e)],_0x399791(0x11e)));return _0x40366b[_0x399791(0x13c)](_0x576ea9)&&(_0x576ea9=null),_0x576ea9;}}else return _0x22a3c6[_0xe38671(0x156)](0x1f4)[_0xe38671(0x113)](_0x2e39d2);}_0x11dc54=JSON['stringify']({'func':_0xba42a6[_0xe38671(0x15b)](),'args':{'transaction':_0x58d22f,'txid':_0x490c1b}}),_0x11dc54={'transactionFamily':TRANSACTION_FAMILY,'transactionFamilyVersion':TRANSACTION_FAMILY_VERSION,'inputs':[_0xe8f29d],'outputs':[_0xe8f29d],'payload':_0x11dc54};try{logFormatted(_0x3623c6+'\x20|\x20BATCH\x20Request:',SEVERITY['NOTIFY'],{..._0x11dc54}),_0x4d703a=await sendTransaction([{..._0x11dc54}]),logFormatted(_0x3623c6+_0xe38671(0x14a)+_0x4d703a[_0xe38671(0x156)]+_0xe38671(0x10c)+_0x4d703a[_0xe38671(0x126)],SEVERITY[_0xe38671(0x10d)]);var _0x170aec=_0xba42a6===HTTP_METHODS[_0xe38671(0x148)]?0xc9:0xc8,_0x324c28=_0x34b822+'\x20'+(_0xba42a6===HTTP_METHODS['POST']?_0xe38671(0x116):_0xe38671(0x10e));const _0x130266=JSON['parse'](_0x58d22f);return delete _0x130266['type'],_0x22a3c6[_0xe38671(0x156)](_0x170aec)['json']({'msg':_0x324c28,'payload':_0x130266});}catch(_0x10f1bb){if(_0xe38671(0x15f)!==_0xe38671(0x10f))return logFormatted(_0x3623c6+_0xe38671(0x13b)+_0x10f1bb,SEVERITY[_0xe38671(0xfd)]),_0x22a3c6[_0xe38671(0x156)](0x1f4)[_0xe38671(0x113)]({'err':_0x10f1bb});else{function _0x3cadbc(){const _0xc2b4e0=_0x423224?function(){const _0x116153=_0x231f;if(_0x1222e0){const _0x53b30a=_0x319f99[_0x116153(0x119)](_0xd02ff5,arguments);return _0x4908ad=null,_0x53b30a;}}:function(){};return _0x28a2ab=![],_0xc2b4e0;}}}},findAssetByAddress=async(_0x4fe364,_0x5967b9,_0x2d1c07,_0x4f64d0)=>{const _0x353bc9=_0x58fc0c;var _0x457ef7,{address:_0x2d1c07}=_0x2d1c07['params'];try{if(_0x457ef7=await this[_0x353bc9(0x12c)](_0x4fe364,_0x2d1c07,null,!0x0,_0x5967b9,_0x4f64d0))return _0x4f64d0[_0x353bc9(0x113)](_0x457ef7);}catch(_0x5d61dc){return _0x4f64d0[_0x353bc9(0x156)](0x1f4)['json'](_0x5d61dc);}},findAllAssets=async(_0xd14f70,_0x3354d9)=>{const _0x1fd2a1=_0x58fc0c;let _0x124215,_0x515cf8;switch(_0xd14f70){case TYPE[_0x1fd2a1(0x103)]:_0x124215=_0x1fd2a1(0x136),_0x515cf8=ADDRESS_PREFIX[_0x1fd2a1(0x103)];break;case TYPE[_0x1fd2a1(0x138)]:_0x124215='user',_0x515cf8=ADDRESS_PREFIX['USER'];}return _0xd14f70=await axios[_0x1fd2a1(0x117)]((process[_0x1fd2a1(0x149)][_0x1fd2a1(0x10a)]||_0x1fd2a1(0xfb))+'/state?address='+(PREFIX+_0x515cf8)+_0x1fd2a1(0x12a),{'headers':{'Content-Type':_0x1fd2a1(0xf6)}}),_0xd14f70=_['chain'](_0xd14f70[_0x1fd2a1(0x13e)][_0x1fd2a1(0x13e)])['filter'](_0x3332bb=>!_[_0x1fd2a1(0x13c)](JSON[_0x1fd2a1(0x125)](Buffer['from'](_0x3332bb[_0x1fd2a1(0x13e)],'base64'))))[_0x1fd2a1(0x100)](_0x3a9f7c=>{const _0x21c8f3=_0x1fd2a1;let _0x28d0c9=JSON[_0x21c8f3(0x125)](Buffer[_0x21c8f3(0x141)](_0x3a9f7c[_0x21c8f3(0x13e)],_0x21c8f3(0x11e)));return _['isEmpty'](_0x28d0c9)&&(_0x28d0c9=null),_0x28d0c9;})[_0x1fd2a1(0x139)]()[_0x1fd2a1(0x112)](),(logFormatted(_0x3354d9+_0x1fd2a1(0x105)+_0x124215+_0x1fd2a1(0x152)+_0xd14f70['length']+'\x20'+_0x124215+(0x1!==_0xd14f70[_0x1fd2a1(0x102)]?'s':'')+'\x20found',0x0===_0xd14f70[_0x1fd2a1(0x102)]?SEVERITY['ERROR']:SEVERITY[_0x1fd2a1(0x10d)]),_0xd14f70);};module[_0x58fc0c(0x111)][_0x58fc0c(0x108)]=TRANSACTION_FAMILY,module[_0x58fc0c(0x111)][_0x58fc0c(0x15e)]=TRANSACTION_FAMILY_VERSION,module[_0x58fc0c(0x111)][_0x58fc0c(0x131)]=hash512,module[_0x58fc0c(0x111)]['getTransactionAddress']=getTransactionAddress,module[_0x58fc0c(0x111)][_0x58fc0c(0x115)]=getUserAddress,module[_0x58fc0c(0x111)][_0x58fc0c(0x128)]=getTransferAddress,module[_0x58fc0c(0x111)][_0x58fc0c(0x14f)]=findByAddress,module[_0x58fc0c(0x111)][_0x58fc0c(0x12c)]=expectExisting,module[_0x58fc0c(0x111)]['findAssetByAddress']=findAssetByAddress,module[_0x58fc0c(0x111)][_0x58fc0c(0xff)]=findAllAssets,module[_0x58fc0c(0x111)][_0x58fc0c(0x10b)]=putAsset;