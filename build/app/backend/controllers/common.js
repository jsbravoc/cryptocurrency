var _0x2a39=['params','address','findAllAssets','\x20|\x20Querying\x20all\x20','POST','TRANSACTION_FAMILY','table','user','prototype','FzaYL','base64','isEmpty','TRANSFER','data','findByAddress','3010138gEzFgc','554oFbWHw','User','SUCCESS','flatten','findAssetByAddress','510934wXIQoI','cnk-cryptocurrency','json','expectExisting','../sawtooth/sawtooth-helpers','isArray','digest','axios','getTransactionAddress','Transfer','415oQKCzb','SAWTOOTH_REST','23057KOpeHM','body','statusText','return\x20(function()\x20','&limit=','22XlFEFo','stack','type','transaction','createHash','underscore','USER','getTransferAddress','parse','updated','stringify','../models/Transaction','replace','/state?address=','dGVPK','\x20doesn\x27t\x20exist','\x20-\x20','toLowerCase','console','sha512','apply','\x0a\x20\x20\x20\x20','\x20with\x20address\x20','exports','value','status','Transaction','hex','application/json','76038dieMiZ','649009aSFnvI','WCaSn','AaBvs','created','{}.constructor(\x22return\x20this\x22)(\x20)','\x20|\x20Error\x20at\x20expectExisting\x20-\x20','bind','1080352MMjaRk','NOTIFY','warn','\x20|\x20BATCH\x20Response:\x20','\x20|\x20BATCH\x20Request:','../utils/logger','exception','TRANSACTION_FAMILY_VERSION','EokPd','toString','__proto__','env','find','\x20found','constructor','length','TRANSACTION','info','jkXcr','slice','myqQS','ERROR','from'];var _0x39e3=function(_0x461588,_0x45c568){_0x461588=_0x461588-0x93;var _0x5562e8=_0x2a39[_0x461588];return _0x5562e8;};var _0x117b04=_0x39e3;(function(_0x542f68,_0x19ea53){var _0x1b5556=_0x39e3;while(!![]){try{var _0x431832=-parseInt(_0x1b5556(0xe5))+parseInt(_0x1b5556(0xbb))*-parseInt(_0x1b5556(0xc0))+-parseInt(_0x1b5556(0xaa))*-parseInt(_0x1b5556(0xb9))+-parseInt(_0x1b5556(0xaf))+parseInt(_0x1b5556(0xdd))+-parseInt(_0x1b5556(0xde))+parseInt(_0x1b5556(0xa9));if(_0x431832===_0x19ea53)break;else _0x542f68['push'](_0x542f68['shift']());}catch(_0x25a786){_0x542f68['push'](_0x542f68['shift']());}}}(_0x2a39,0x8acd9));var _0xf989f1=function(){var _0x38e61c=!![];return function(_0xd9935b,_0x26860c){var _0x4e85a2=_0x38e61c?function(){var _0x3a1c15=_0x39e3;if(_0x26860c){if(_0x3a1c15(0xdf)==='WCaSn'){var _0x56ba0b=_0x26860c[_0x3a1c15(0xd4)](_0xd9935b,arguments);return _0x26860c=null,_0x56ba0b;}else{function _0x196a86(){var _0x55c0d1=_0x3a1c15,_0x2ebae1=new _0x4099ef()[_0x55c0d1(0xc1)][_0x55c0d1(0xcc)]('\x0a\x20\x20\x20\x20','\x20'),_0x11d05a=_0xdad6cd+'\x20with\x20address\x20'+_0x4da3c6+'\x20doesn\x27t\x20exist';throw _0x58cc73(_0x143e53+_0x55c0d1(0xe3)+_0x11d05a,_0x4e0a10['ERROR']),_0x25a8b5['status'](0x194)['json']({'error':_0x11d05a,'function':_0x55c0d1(0xb2),'parameters':[_0x52f163?{'txid':_0x3d3535,'transaction':_0xe59c8b}:{'txid':_0x420f56}],'stackTrace':_0x2ebae1}),new _0x219769(_0x11d05a);}}}}:function(){};return _0x38e61c=![],_0x4e85a2;};}(),_0x3574e5=_0xf989f1(this,function(){var _0x3653cb=_0x39e3,_0x3960be;try{if('uwgbk'!==_0x3653cb(0xe0)){var _0x478d7e=Function(_0x3653cb(0xbe)+_0x3653cb(0xe2)+');');_0x3960be=_0x478d7e();}else{function _0x135ba2(){var _0x11c11b=_0x3653cb,_0x242cee=_0x1c9744[_0x11c11b(0xf3)][_0x11c11b(0xa2)][_0x11c11b(0xe4)](_0x3c4e7b),_0x2a4c68=_0x294249[_0x56d4c5],_0x3faf36=_0x540e30[_0x2a4c68]||_0x242cee;_0x242cee['__proto__']=_0xbc34e7[_0x11c11b(0xe4)](_0x235a4b),_0x242cee['toString']=_0x3faf36[_0x11c11b(0xee)]['bind'](_0x3faf36),_0x1d5d71[_0x2a4c68]=_0x242cee;}}}catch(_0x1beadc){_0x3960be=window;}var _0x448bc8=_0x3960be['console']=_0x3960be[_0x3653cb(0xd2)]||{},_0x50ed18=['log',_0x3653cb(0xe7),_0x3653cb(0x94),'error',_0x3653cb(0xeb),_0x3653cb(0xa0),'trace'];for(var _0x3c192e=0x0;_0x3c192e<_0x50ed18['length'];_0x3c192e++){if(_0x3653cb(0x95)===_0x3653cb(0x95)){var _0x29041d=_0xf989f1['constructor']['prototype'][_0x3653cb(0xe4)](_0xf989f1),_0x31adad=_0x50ed18[_0x3c192e],_0x4b3fd0=_0x448bc8[_0x31adad]||_0x29041d;_0x29041d[_0x3653cb(0xef)]=_0xf989f1[_0x3653cb(0xe4)](_0xf989f1),_0x29041d[_0x3653cb(0xee)]=_0x4b3fd0['toString'][_0x3653cb(0xe4)](_0x4b3fd0),_0x448bc8[_0x31adad]=_0x29041d;}else{function _0x283493(){var _0x2edab0=_0x3653cb,_0x109527=_0xf5de9d[_0x2edab0(0xd4)](_0x1d582c,arguments);return _0x5c494b=null,_0x109527;}}}});_0x3574e5();const _=require(_0x117b04(0xc5)),crypto=require('crypto'),{default:axios}=require(_0x117b04(0xb6)),{TYPE,ADDRESS_PREFIX,HTTP_METHODS}=require('../utils/constants'),{logFormatted,SEVERITY}=require(_0x117b04(0xea)),TRANSACTION_FAMILY=_0x117b04(0xb0),TRANSACTION_FAMILY_VERSION='1.0',{queryState,sendTransaction}=require(_0x117b04(0xb3)),Transaction=require(_0x117b04(0xcb)),User=require('../models/User'),Transfer=require('../models/Transfer'),hash512=_0x37eb8e=>crypto[_0x117b04(0xc4)](_0x117b04(0xd3))['update'](_0x37eb8e)[_0x117b04(0xb5)](_0x117b04(0xdb)),getAddress=(_0x2ec327,_0x437327=0x40)=>hash512(_0x2ec327)[_0x117b04(0x96)](0x0,_0x437327),PREFIX=getAddress(TRANSACTION_FAMILY,0x6),getTransactionAddress=_0x16eebd=>PREFIX+ADDRESS_PREFIX[_0x117b04(0x93)]+getAddress(_0x16eebd,0x3e),getUserAddress=_0x3d3e2f=>PREFIX+ADDRESS_PREFIX[_0x117b04(0xc6)]+getAddress(_0x3d3e2f,0x3e),getTransferAddress=_0x1e1c08=>PREFIX+ADDRESS_PREFIX['TRANSFER']+getAddress(_0x1e1c08,0x3e),findByAddress=async(_0x4eb262,_0x311391)=>{var _0x12eb68=_0x117b04;let _0x3bea34;switch(_0x4eb262){case TYPE[_0x12eb68(0x93)]:_0x3bea34=getTransactionAddress(_0x311391);break;case TYPE[_0x12eb68(0xc6)]:_0x3bea34=getUserAddress(_0x311391);break;default:return null;}let _0x8c4dc5;return _0x8c4dc5=await queryState(_0x3bea34),_0x8c4dc5?(Array[_0x12eb68(0xb4)](_0x8c4dc5)&&(_0x8c4dc5=_0x8c4dc5[_0x12eb68(0xf1)](_0x11b64d=>_0x11b64d[_0x12eb68(0x9b)]===_0x3bea34)),_0x8c4dc5):null;},expectExisting=async(_0x34cb41,_0x104c8f,_0x1d6015,_0x3385d6,_0x27f38f,_0x41f9c6)=>{var _0x3c3561=_0x117b04;let _0xe8439c;switch(_0x34cb41){case TYPE[_0x3c3561(0x93)]:_0xe8439c=_0x3c3561(0xda);break;case TYPE['USER']:_0xe8439c='User';break;case TYPE[_0x3c3561(0xa6)]:_0xe8439c=_0x3c3561(0xb8);}var _0x1ecee7=await this['findByAddress'](_0x34cb41,_0x104c8f);if(_0x3385d6&&!_0x1ecee7){var _0x3aaab4=new Error()[_0x3c3561(0xc1)][_0x3c3561(0xcc)](_0x3c3561(0xd5),'\x20'),_0x34cb41=_0xe8439c+_0x3c3561(0xd6)+_0x104c8f+_0x3c3561(0xcf);throw logFormatted(_0x27f38f+_0x3c3561(0xe3)+_0x34cb41,SEVERITY[_0x3c3561(0x98)]),_0x41f9c6[_0x3c3561(0xd9)](0x194)[_0x3c3561(0xb1)]({'error':_0x34cb41,'function':_0x3c3561(0xb2),'parameters':[_0x1d6015?{'txid':_0x104c8f,'transaction':_0x1d6015}:{'txid':_0x104c8f}],'stackTrace':_0x3aaab4}),new Error(_0x34cb41);}if(_0x3385d6||!_0x1ecee7)return _0x1ecee7;_0x3385d6=new Error()[_0x3c3561(0xc1)][_0x3c3561(0xcc)](_0x3c3561(0xd5),'\x20'),_0x1ecee7=_0xe8439c+_0x3c3561(0xd6)+_0x104c8f+'\x20already\x20exists';throw logFormatted(_0x27f38f+_0x3c3561(0xe3)+_0x1ecee7,SEVERITY[_0x3c3561(0x98)]),_0x41f9c6['status'](0x194)['json']({'error':_0x1ecee7,'function':_0x3c3561(0xb2),'parameters':[{'txid':_0x104c8f,'transaction':_0x1d6015}],'stackTrace':_0x3385d6}),new Error(_0x1ecee7);},putAsset=async(_0x19b9b9,_0x598b9a,_0x1f563f,_0x578d5d,_0x3bcc54)=>{var _0x39b88b=_0x117b04;let _0xde766c,_0x17338e,_0x5e50e9,_0x176b46;var {description:_0x1f1d1b}=_0x578d5d[_0x39b88b(0xbc)],{signature:_0x33df86}=_0x578d5d[_0x39b88b(0xbc)];switch(_0x19b9b9){case TYPE[_0x39b88b(0x93)]:_0x176b46=_0x39b88b(0xda);var {amount:_0x553c1c,recipient:_0x46d338,sender:_0x139934,valid:_0x20c1d6,valid_thru:_0x2da0bc}=_0x578d5d[_0x39b88b(0xbc)];_0x17338e=_0x33df86,_0xde766c=new Transaction(_0x553c1c,_0x46d338,_0x139934,_0x1f1d1b,_0x20c1d6,_0x2da0bc,_0x33df86)[_0x39b88b(0xee)](!0x1,!0x1),_0x5e50e9=getTransactionAddress(_0x17338e);break;case TYPE['USER']:_0x176b46=_0x39b88b(0xab);const _0x2cf203=new User(_0x578d5d[_0x39b88b(0xbc)]);_0x17338e=_0x2cf203['address'],_0xde766c=_0x2cf203[_0x39b88b(0xee)](!0x0,!0x1),_0x5e50e9=getUserAddress(_0x17338e);break;case TYPE['TRANSFER']:_0x176b46=_0x39b88b(0xb8);const _0x1305aa=new Transfer(_0x578d5d[_0x39b88b(0xbc)]);_0x17338e=_0x1305aa['toHash'](),_0xde766c=_0x1305aa[_0x39b88b(0xee)](!0x0,!0x1),_0x5e50e9=getTransferAddress(_0x17338e);}try{await expectExisting(_0x19b9b9,_0x17338e,_0xde766c,_0x598b9a!==HTTP_METHODS['POST'],_0x1f563f,_0x3bcc54);}catch(_0x30c873){if('dGVPK'===_0x39b88b(0xce))return _0x3bcc54['status'](0x1f4)[_0x39b88b(0xb1)](_0x30c873);else{function _0x7c4821(){var _0x8a6685=_0x39b88b;return _0xf97b13[_0x8a6685(0xd9)](0x1f4)['json'](_0x2f17d0);}}}var _0x7ae0a9,_0x19b9b9=JSON[_0x39b88b(0xca)]({'func':_0x598b9a[_0x39b88b(0xd1)](),'args':{'transaction':_0xde766c,'txid':_0x17338e}}),_0x19b9b9={'transactionFamily':TRANSACTION_FAMILY,'transactionFamilyVersion':TRANSACTION_FAMILY_VERSION,'inputs':[_0x5e50e9],'outputs':[_0x5e50e9],'payload':_0x19b9b9};try{logFormatted(_0x1f563f+_0x39b88b(0xe9),SEVERITY[_0x39b88b(0xe6)],{..._0x19b9b9}),_0x7ae0a9=await sendTransaction([{..._0x19b9b9}]),logFormatted(_0x1f563f+'\x20\x20|\x20BATCH\x20Response:\x20'+_0x7ae0a9[_0x39b88b(0xd9)]+_0x39b88b(0xd0)+_0x7ae0a9[_0x39b88b(0xbd)],SEVERITY[_0x39b88b(0xac)]);var _0x4e7a5a=_0x598b9a===HTTP_METHODS[_0x39b88b(0x9e)]?0xc9:0xc8,_0x3c81d6=_0x176b46+'\x20'+(_0x598b9a===HTTP_METHODS[_0x39b88b(0x9e)]?_0x39b88b(0xe1):_0x39b88b(0xc9));const _0xdacf98=JSON['parse'](_0xde766c);return delete _0xdacf98[_0x39b88b(0xc2)],_0x3bcc54[_0x39b88b(0xd9)](_0x4e7a5a)[_0x39b88b(0xb1)]({'msg':_0x3c81d6,'payload':_0xdacf98});}catch(_0x2a29f8){return logFormatted(_0x1f563f+_0x39b88b(0xe8)+_0x2a29f8,SEVERITY[_0x39b88b(0x98)]),_0x3bcc54['status'](0x1f4)[_0x39b88b(0xb1)]({'err':_0x2a29f8});}},findAssetByAddress=async(_0x3dada5,_0x3c7a84,_0x59ac2f,_0x443f13)=>{var _0x4ed53d=_0x117b04,_0x305a03,{address:_0x59ac2f}=_0x59ac2f[_0x4ed53d(0x9a)];try{if(_0x305a03=await this[_0x4ed53d(0xb2)](_0x3dada5,_0x59ac2f,null,!0x0,_0x3c7a84,_0x443f13))return _0x443f13[_0x4ed53d(0xb1)](_0x305a03);}catch(_0x50841d){if(_0x4ed53d(0xa3)===_0x4ed53d(0x97)){function _0x465134(){var _0x2adfd6=_0x4ed53d,_0x10cdfc=_0x2e00c9(_0x2adfd6(0xbe)+_0x2adfd6(0xe2)+');');_0x2af7f0=_0x10cdfc();}}else return _0x443f13[_0x4ed53d(0xd9)](0x1f4)['json'](_0x50841d);}return _0x443f13['status'](0x1f4);},findAllAssets=async(_0x402233,_0x139f6d,_0x3e8b94=0x14)=>{var _0x496a8c=_0x117b04;let _0x12014f,_0x1e0588;switch(_0x402233){case TYPE[_0x496a8c(0x93)]:_0x12014f=_0x496a8c(0xc3),_0x1e0588=ADDRESS_PREFIX['TRANSACTION'];break;case TYPE['USER']:_0x12014f=_0x496a8c(0xa1),_0x1e0588=ADDRESS_PREFIX[_0x496a8c(0xc6)];}return _0x3e8b94=await axios['get']((process[_0x496a8c(0xf0)][_0x496a8c(0xba)]||'http://localhost:8008')+_0x496a8c(0xcd)+(PREFIX+_0x1e0588)+(0x0!==_0x3e8b94?_0x496a8c(0xbf)+_0x3e8b94:''),{'headers':{'Content-Type':_0x496a8c(0xdc)}}),_0x3e8b94=_['chain'](_0x3e8b94[_0x496a8c(0xa7)][_0x496a8c(0xa7)])['filter'](_0x4710e3=>!_[_0x496a8c(0xa5)](JSON[_0x496a8c(0xc8)](Buffer[_0x496a8c(0x99)](_0x4710e3[_0x496a8c(0xa7)],_0x496a8c(0xa4)))))['map'](_0x319401=>{var _0x40f5aa=_0x496a8c;if(_0x40f5aa(0xed)==='EokPd'){let _0x3af2e8=JSON[_0x40f5aa(0xc8)](Buffer[_0x40f5aa(0x99)](_0x319401[_0x40f5aa(0xa7)],_0x40f5aa(0xa4)));return _['isEmpty'](_0x3af2e8)&&(_0x3af2e8=null),_0x3af2e8;}else{function _0x1f5d14(){var _0x2b1b7a=_0x2e06d6?function(){var _0xa526ee=_0x39e3;if(_0x565ad7){var _0xeb0e78=_0x551f0a[_0xa526ee(0xd4)](_0xa9df93,arguments);return _0x2a9b78=null,_0xeb0e78;}}:function(){};return _0xcaf72f=![],_0x2b1b7a;}}})[_0x496a8c(0xad)]()[_0x496a8c(0xd8)](),(logFormatted(_0x139f6d+_0x496a8c(0x9d)+_0x12014f+'s\x20-\x20'+_0x3e8b94['length']+'\x20'+_0x12014f+(0x1!==_0x3e8b94[_0x496a8c(0xf4)]?'s':'')+_0x496a8c(0xf2),0x0===_0x3e8b94[_0x496a8c(0xf4)]?SEVERITY['ERROR']:SEVERITY[_0x496a8c(0xac)]),_0x3e8b94);};module['exports'][_0x117b04(0x9f)]=TRANSACTION_FAMILY,module['exports'][_0x117b04(0xec)]=TRANSACTION_FAMILY_VERSION,module[_0x117b04(0xd7)]['hash512']=hash512,module[_0x117b04(0xd7)][_0x117b04(0xb7)]=getTransactionAddress,module[_0x117b04(0xd7)]['getUserAddress']=getUserAddress,module[_0x117b04(0xd7)][_0x117b04(0xc7)]=getTransferAddress,module['exports'][_0x117b04(0xa8)]=findByAddress,module[_0x117b04(0xd7)][_0x117b04(0xb2)]=expectExisting,module[_0x117b04(0xd7)][_0x117b04(0xae)]=findAssetByAddress,module[_0x117b04(0xd7)][_0x117b04(0x9c)]=findAllAssets,module[_0x117b04(0xd7)]['putAsset']=putAsset;