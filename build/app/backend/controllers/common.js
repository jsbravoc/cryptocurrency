var _0x7ca4=['env','from','Transfer','filter','stack','expectExisting','eZQbe','&limit=','3furVKf','findByAddress','crypto','toLowerCase','USER','\x20|\x20Querying\x20all\x20','433zVtbTG','return\x20(function()\x20','461649vRWEcx','292951ISEAlX','get','bind','getUserAddress','482293uSGTag','s\x20-\x20','params','console','1vSUJpu','application/json','replace','\x20with\x20address\x20','json','SUCCESS','SAWTOOTH_REST','TRANSACTION','\x20doesn\x27t\x20exist','\x20found','19813kfWOXO','1.0','update','User','hex','status','transaction','http://localhost:8008','../models/User','createHash','../models/Transfer','warn','NOTIFY','toHash','{}.constructor(\x22return\x20this\x22)(\x20)','flatten','parse','TRANSFER','exports','value','slice','POST','findAllAssets','constructor','\x20|\x20BATCH\x20Request:','prototype','type','trace','base64','axios','chain','ERROR','putAsset','67EnzvDp','log','find','\x20-\x20','\x20|\x20Error\x20at\x20expectExisting\x20-\x20','\x0a\x20\x20\x20\x20','body','data','\x20already\x20exists','1vqtasp','\x20\x20|\x20BATCH\x20Response:\x20','isArray','created','length','updated','isEmpty','address','error','toString','../sawtooth/sawtooth-helpers','getTransactionAddress','../utils/logger','info','digest','791RSzIOH','\x20|\x20BATCH\x20Response:\x20','../models/Transaction','632497vOUhPO','findAssetByAddress','underscore','304947vnHAMb'];var _0x43e8=function(_0x366a46,_0x3287d3){_0x366a46=_0x366a46-0x1e5;var _0x1eaf8e=_0x7ca4[_0x366a46];return _0x1eaf8e;};var _0x3f070c=_0x43e8;(function(_0x36e3e2,_0x8dbda1){var _0x4b784b=_0x43e8;while(!![]){try{var _0x19aca6=parseInt(_0x4b784b(0x23c))+parseInt(_0x4b784b(0x20c))*parseInt(_0x4b784b(0x1eb))+parseInt(_0x4b784b(0x239))*-parseInt(_0x4b784b(0x224))+-parseInt(_0x4b784b(0x233))*parseInt(_0x4b784b(0x23b))+-parseInt(_0x4b784b(0x22a))+parseInt(_0x4b784b(0x227))*parseInt(_0x4b784b(0x215))+-parseInt(_0x4b784b(0x244))*-parseInt(_0x4b784b(0x240));if(_0x19aca6===_0x8dbda1)break;else _0x36e3e2['push'](_0x36e3e2['shift']());}catch(_0x2c6a3d){_0x36e3e2['push'](_0x36e3e2['shift']());}}}(_0x7ca4,0xab95f));var _0x640494=function(){var _0x51b915=!![];return function(_0x223656,_0x1dadb7){var _0x4fa926=_0x43e8;if('eZQbe'===_0x4fa926(0x231)){var _0x487772=_0x51b915?function(){if(_0x1dadb7){var _0x27b6e7=_0x1dadb7['apply'](_0x223656,arguments);return _0x1dadb7=null,_0x27b6e7;}}:function(){};return _0x51b915=![],_0x487772;}else{function _0x5ca485(){var _0x1cbca4=_0x4fa926,_0x3ea134=_0x3536a1(_0x1cbca4(0x23a)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x463e5a=_0x3ea134();}}};}(),_0x25a948=_0x640494(this,function(){var _0x412265=_0x43e8,_0x2d9063;try{var _0x5e22ff=Function('return\x20(function()\x20'+_0x412265(0x1f9)+');');_0x2d9063=_0x5e22ff();}catch(_0x29fd5c){_0x2d9063=window;}var _0x42cc8a=_0x2d9063[_0x412265(0x243)]=_0x2d9063[_0x412265(0x243)]||{},_0x550d0f=[_0x412265(0x20d),_0x412265(0x1f6),_0x412265(0x222),_0x412265(0x21d),'exception','table',_0x412265(0x206)];for(var _0x15012c=0x0;_0x15012c<_0x550d0f[_0x412265(0x219)];_0x15012c++){var _0x2ad7bb=_0x640494[_0x412265(0x202)][_0x412265(0x204)][_0x412265(0x23e)](_0x640494),_0xbaa86e=_0x550d0f[_0x15012c],_0xad6678=_0x42cc8a[_0xbaa86e]||_0x2ad7bb;_0x2ad7bb['__proto__']=_0x640494[_0x412265(0x23e)](_0x640494),_0x2ad7bb['toString']=_0xad6678['toString'][_0x412265(0x23e)](_0xad6678),_0x42cc8a[_0xbaa86e]=_0x2ad7bb;}});_0x25a948();const _=require(_0x3f070c(0x229)),crypto=require(_0x3f070c(0x235)),{default:axios}=require(_0x3f070c(0x208)),{TYPE,ADDRESS_PREFIX,HTTP_METHODS}=require('../utils/constants'),{logFormatted,SEVERITY}=require(_0x3f070c(0x221)),TRANSACTION_FAMILY='cnk-cryptocurrency',TRANSACTION_FAMILY_VERSION=_0x3f070c(0x1ec),{queryState,sendTransaction}=require(_0x3f070c(0x21f)),Transaction=require(_0x3f070c(0x226)),User=require(_0x3f070c(0x1f3)),Transfer=require(_0x3f070c(0x1f5)),hash512=_0x2ee73b=>crypto[_0x3f070c(0x1f4)]('sha512')[_0x3f070c(0x1ed)](_0x2ee73b)[_0x3f070c(0x223)](_0x3f070c(0x1ef)),getAddress=(_0x49d72b,_0x15e8c1=0x40)=>hash512(_0x49d72b)[_0x3f070c(0x1ff)](0x0,_0x15e8c1),PREFIX=getAddress(TRANSACTION_FAMILY,0x6),getTransactionAddress=_0x266fe3=>PREFIX+ADDRESS_PREFIX[_0x3f070c(0x1e8)]+getAddress(_0x266fe3,0x3e),getUserAddress=_0x4db485=>PREFIX+ADDRESS_PREFIX[_0x3f070c(0x237)]+getAddress(_0x4db485,0x3e),getTransferAddress=_0x40a080=>PREFIX+ADDRESS_PREFIX['TRANSFER']+getAddress(_0x40a080,0x3e),findByAddress=async(_0x14e3f2,_0x47ae27)=>{var _0xb2f428=_0x3f070c;let _0x548c26;switch(_0x14e3f2){case TYPE[_0xb2f428(0x1e8)]:_0x548c26=getTransactionAddress(_0x47ae27);break;case TYPE[_0xb2f428(0x237)]:_0x548c26=getUserAddress(_0x47ae27);break;default:return null;}let _0x2d5082;return _0x2d5082=await queryState(_0x548c26),_0x2d5082?(Array[_0xb2f428(0x217)](_0x2d5082)&&(_0x2d5082=_0x2d5082[_0xb2f428(0x20e)](_0x4704c6=>_0x4704c6[_0xb2f428(0x21c)]===_0x548c26)),_0x2d5082):null;},expectExisting=async(_0x425fb0,_0x2521c3,_0x3ce7fd,_0x31334d,_0x4422e9,_0x20aedf)=>{var _0x2282bd=_0x3f070c;let _0x1549c6;switch(_0x425fb0){case TYPE['TRANSACTION']:_0x1549c6='Transaction';break;case TYPE[_0x2282bd(0x237)]:_0x1549c6='User';break;case TYPE['TRANSFER']:_0x1549c6='Transfer';}var _0x5bf9a5=await this[_0x2282bd(0x234)](_0x425fb0,_0x2521c3);if(_0x31334d&&!_0x5bf9a5){var _0x1e7786=new Error()[_0x2282bd(0x22f)][_0x2282bd(0x246)](_0x2282bd(0x211),'\x20'),_0x425fb0=_0x1549c6+_0x2282bd(0x247)+_0x2521c3+_0x2282bd(0x1e9);throw logFormatted(_0x4422e9+_0x2282bd(0x210)+_0x425fb0,SEVERITY['ERROR']),_0x20aedf[_0x2282bd(0x1f0)](0x194)[_0x2282bd(0x1e5)]({'error':_0x425fb0,'function':'expectExisting','parameters':[_0x3ce7fd?{'txid':_0x2521c3,'transaction':_0x3ce7fd}:{'txid':_0x2521c3}],'stackTrace':_0x1e7786}),new Error(_0x425fb0);}if(_0x31334d||!_0x5bf9a5)return _0x5bf9a5;_0x31334d=new Error()[_0x2282bd(0x22f)][_0x2282bd(0x246)]('\x0a\x20\x20\x20\x20','\x20'),_0x5bf9a5=_0x1549c6+'\x20with\x20address\x20'+_0x2521c3+_0x2282bd(0x214);throw logFormatted(_0x4422e9+_0x2282bd(0x210)+_0x5bf9a5,SEVERITY['ERROR']),_0x20aedf['status'](0x194)[_0x2282bd(0x1e5)]({'error':_0x5bf9a5,'function':_0x2282bd(0x230),'parameters':[{'txid':_0x2521c3,'transaction':_0x3ce7fd}],'stackTrace':_0x31334d}),new Error(_0x5bf9a5);},putAsset=async(_0x3e4e6b,_0x4d375e,_0x367dd8,_0x30cac7,_0x5db0bf)=>{var _0x2bc7b8=_0x3f070c;let _0x379bcd,_0x256b38,_0x2b26e6,_0x5c4db7;var {description:_0x520b66}=_0x30cac7[_0x2bc7b8(0x212)],{signature:_0x1aaba1}=_0x30cac7[_0x2bc7b8(0x212)];switch(_0x3e4e6b){case TYPE[_0x2bc7b8(0x1e8)]:_0x5c4db7='Transaction';var {amount:_0x4c1feb,recipient:_0x3c7f81,sender:_0x341e8f,valid:_0x29d946,valid_thru:_0x3bd837}=_0x30cac7[_0x2bc7b8(0x212)];_0x256b38=_0x1aaba1,_0x379bcd=new Transaction(_0x4c1feb,_0x3c7f81,_0x341e8f,_0x520b66,_0x29d946,_0x3bd837,_0x1aaba1)[_0x2bc7b8(0x21e)](!0x1,!0x1),_0x2b26e6=getTransactionAddress(_0x256b38);break;case TYPE[_0x2bc7b8(0x237)]:_0x5c4db7=_0x2bc7b8(0x1ee);const _0x301b83=new User(_0x30cac7['body']);_0x256b38=_0x301b83[_0x2bc7b8(0x21c)],_0x379bcd=_0x301b83['toString'](!0x0,!0x1),_0x2b26e6=getUserAddress(_0x256b38);break;case TYPE[_0x2bc7b8(0x1fc)]:_0x5c4db7=_0x2bc7b8(0x22d);const _0x4097d9=new Transfer(_0x30cac7['body']);_0x256b38=_0x4097d9[_0x2bc7b8(0x1f8)](),_0x379bcd=_0x4097d9[_0x2bc7b8(0x21e)](!0x0,!0x1),_0x2b26e6=getTransferAddress(_0x256b38);}try{await expectExisting(_0x3e4e6b,_0x256b38,_0x379bcd,_0x4d375e!==HTTP_METHODS[_0x2bc7b8(0x200)],_0x367dd8,_0x5db0bf);}catch(_0xa6c2bc){return _0x5db0bf[_0x2bc7b8(0x1f0)](0x1f4)[_0x2bc7b8(0x1e5)](_0xa6c2bc);}var _0x44fc0c,_0x3e4e6b=JSON['stringify']({'func':_0x4d375e[_0x2bc7b8(0x236)](),'args':{'transaction':_0x379bcd,'txid':_0x256b38}}),_0x3e4e6b={'transactionFamily':TRANSACTION_FAMILY,'transactionFamilyVersion':TRANSACTION_FAMILY_VERSION,'inputs':[_0x2b26e6],'outputs':[_0x2b26e6],'payload':_0x3e4e6b};try{logFormatted(_0x367dd8+_0x2bc7b8(0x203),SEVERITY[_0x2bc7b8(0x1f7)],{..._0x3e4e6b}),_0x44fc0c=await sendTransaction([{..._0x3e4e6b}]),logFormatted(_0x367dd8+_0x2bc7b8(0x216)+_0x44fc0c[_0x2bc7b8(0x1f0)]+_0x2bc7b8(0x20f)+_0x44fc0c['statusText'],SEVERITY[_0x2bc7b8(0x1e6)]);var _0x350887=_0x4d375e===HTTP_METHODS['POST']?0xc9:0xc8,_0x1f274e=_0x5c4db7+'\x20'+(_0x4d375e===HTTP_METHODS[_0x2bc7b8(0x200)]?_0x2bc7b8(0x218):_0x2bc7b8(0x21a));const _0x39a310=JSON[_0x2bc7b8(0x1fb)](_0x379bcd);return delete _0x39a310[_0x2bc7b8(0x205)],_0x5db0bf[_0x2bc7b8(0x1f0)](_0x350887)[_0x2bc7b8(0x1e5)]({'msg':_0x1f274e,'payload':_0x39a310});}catch(_0x48dfea){return logFormatted(_0x367dd8+_0x2bc7b8(0x225)+_0x48dfea,SEVERITY[_0x2bc7b8(0x20a)]),_0x5db0bf['status'](0x1f4)[_0x2bc7b8(0x1e5)]({'err':_0x48dfea});}},findAssetByAddress=async(_0x2ca9f3,_0x2272fd,_0x2804a1,_0x424d32)=>{var _0x17acf6=_0x3f070c,_0x3909fd,{address:_0x2804a1}=_0x2804a1[_0x17acf6(0x242)];try{if(_0x3909fd=await this[_0x17acf6(0x230)](_0x2ca9f3,_0x2804a1,null,!0x0,_0x2272fd,_0x424d32))return _0x424d32['json'](_0x3909fd);}catch(_0x44e356){return _0x424d32[_0x17acf6(0x1f0)](0x1f4)[_0x17acf6(0x1e5)](_0x44e356);}return _0x424d32[_0x17acf6(0x1f0)](0x1f4);},findAllAssets=async(_0x458a48,_0x5a0349,_0x4a3cb1=0x14)=>{var _0x6a5061=_0x3f070c;let _0x4b2e25,_0x55f8e2;switch(_0x458a48){case TYPE['TRANSACTION']:_0x4b2e25=_0x6a5061(0x1f1),_0x55f8e2=ADDRESS_PREFIX['TRANSACTION'];break;case TYPE[_0x6a5061(0x237)]:_0x4b2e25='user',_0x55f8e2=ADDRESS_PREFIX['USER'];}return _0x4a3cb1=await axios[_0x6a5061(0x23d)]((process[_0x6a5061(0x22b)][_0x6a5061(0x1e7)]||_0x6a5061(0x1f2))+'/state?address='+(PREFIX+_0x55f8e2)+(0x0!==_0x4a3cb1?_0x6a5061(0x232)+_0x4a3cb1:''),{'headers':{'Content-Type':_0x6a5061(0x245)}}),_0x4a3cb1=_[_0x6a5061(0x209)](_0x4a3cb1[_0x6a5061(0x213)][_0x6a5061(0x213)])[_0x6a5061(0x22e)](_0x2f857d=>!_[_0x6a5061(0x21b)](JSON[_0x6a5061(0x1fb)](Buffer[_0x6a5061(0x22c)](_0x2f857d[_0x6a5061(0x213)],'base64'))))['map'](_0x24a318=>{var _0x7d530b=_0x6a5061;let _0x4f9c12=JSON['parse'](Buffer[_0x7d530b(0x22c)](_0x24a318[_0x7d530b(0x213)],_0x7d530b(0x207)));return _[_0x7d530b(0x21b)](_0x4f9c12)&&(_0x4f9c12=null),_0x4f9c12;})[_0x6a5061(0x1fa)]()[_0x6a5061(0x1fe)](),(logFormatted(_0x5a0349+_0x6a5061(0x238)+_0x4b2e25+_0x6a5061(0x241)+_0x4a3cb1[_0x6a5061(0x219)]+'\x20'+_0x4b2e25+(0x1!==_0x4a3cb1['length']?'s':'')+_0x6a5061(0x1ea),0x0===_0x4a3cb1[_0x6a5061(0x219)]?SEVERITY[_0x6a5061(0x20a)]:SEVERITY[_0x6a5061(0x1e6)]),_0x4a3cb1);};module[_0x3f070c(0x1fd)]['TRANSACTION_FAMILY']=TRANSACTION_FAMILY,module[_0x3f070c(0x1fd)]['TRANSACTION_FAMILY_VERSION']=TRANSACTION_FAMILY_VERSION,module[_0x3f070c(0x1fd)]['hash512']=hash512,module[_0x3f070c(0x1fd)][_0x3f070c(0x220)]=getTransactionAddress,module[_0x3f070c(0x1fd)][_0x3f070c(0x23f)]=getUserAddress,module['exports']['getTransferAddress']=getTransferAddress,module['exports']['findByAddress']=findByAddress,module[_0x3f070c(0x1fd)][_0x3f070c(0x230)]=expectExisting,module[_0x3f070c(0x1fd)][_0x3f070c(0x228)]=findAssetByAddress,module['exports'][_0x3f070c(0x201)]=findAllAssets,module[_0x3f070c(0x1fd)][_0x3f070c(0x20b)]=putAsset;