const _0x1ad3=['exception','signature','not','run','array','USER','lastest_transactions','express-validator','1184429SCYTgU','map','1609RxTOFI','status','VSkyS','bail','218rkAlar','The\x20signature\x20of\x20the\x20transaction\x20is\x20required','isEmpty','toString','TRANSACTION','83UwlZPa','\x20does\x20not\x20belong\x20to\x20them.\x20Expected\x20recipient:\x20','Insufficient\x20funds.\x20User\x27s\x20lastest\x20transaction\x20reflect\x20a\x20balance\x20of\x20','warn','constructor','trace','889bxSfYu','isFloat','withMessage','apply','404jkTYgH','req.body.sender','PUVsc','trim','validateTransactionCreation','562240RCMWHF','kZqYo','6469hlWfYS','1514127CAhwmA','recipient','console','length','json','return\x20(function()\x20','ZdqDy','VtyTX','amount',',\x20actual\x20recipient:\x20','1681DlAIwd','./users','isArray','4429xRSsQf','exports','bind','optional','}\x20does\x20not\x20have\x20any\x20lastest_transactions','custom','all','../controllers/common','table','info','User\x20with\x20address\x20{','}\x20\x20does\x20not\x20exist','sender','__proto__','User\x27s\x20lastest\x20transaction\x20with\x20address\x20','body','log','{}.constructor(\x22return\x20this\x22)(\x20)','RObyq',',\x20and\x20the\x20transaction\x20amount\x20is\x20','prototype'];const _0x34b8=function(_0x2ecbe2,_0x5f2882){_0x2ecbe2=_0x2ecbe2-0x13a;let _0x54e4c8=_0x1ad3[_0x2ecbe2];return _0x54e4c8;};const _0x43a725=_0x34b8;(function(_0x38a2c5,_0x2909a8){const _0x5dbe65=_0x34b8;while(!![]){try{const _0x187678=parseInt(_0x5dbe65(0x145))+parseInt(_0x5dbe65(0x171))*parseInt(_0x5dbe65(0x180))+-parseInt(_0x5dbe65(0x17a))*-parseInt(_0x5dbe65(0x152))+-parseInt(_0x5dbe65(0x142))+-parseInt(_0x5dbe65(0x16f))+-parseInt(_0x5dbe65(0x144))*parseInt(_0x5dbe65(0x175))+-parseInt(_0x5dbe65(0x13d))*-parseInt(_0x5dbe65(0x14f));if(_0x187678===_0x2909a8)break;else _0x38a2c5['push'](_0x38a2c5['shift']());}catch(_0x454a1f){_0x38a2c5['push'](_0x38a2c5['shift']());}}}(_0x1ad3,0xcbb2c));const _0x174e80=function(){let _0x26037a=!![];return function(_0x534c45,_0x456808){const _0x26c83d=_0x34b8;if(_0x26c83d(0x14c)!==_0x26c83d(0x173)){const _0x352a70=_0x26037a?function(){const _0x2d15d7=_0x26c83d;if(_0x456808){if(_0x2d15d7(0x14b)!==_0x2d15d7(0x14b)){function _0x3ab873(){const _0x5cde41=_0x2d15d7;_0x4a0445=_0x35a645(_0x5cde41(0x14a)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}}else{const _0x3fc974=_0x456808[_0x2d15d7(0x13c)](_0x534c45,arguments);return _0x456808=null,_0x3fc974;}}}:function(){};return _0x26037a=![],_0x352a70;}else{function _0x5cfebe(){const _0xd12f13=_0x26c83d;let _0x9992bf;try{_0x9992bf=_0x12cdd2(_0xd12f13(0x14a)+_0xd12f13(0x163)+');')();}catch(_0x39c14e){_0x9992bf=_0x21b301;}return _0x9992bf;}}};}(),_0x51b1b9=_0x174e80(this,function(){const _0x44e30d=_0x34b8,_0x3b89cc=function(){const _0x4eccec=_0x34b8;let _0x3eb804;try{_0x3eb804=Function('return\x20(function()\x20'+_0x4eccec(0x163)+');')();}catch(_0x5df52c){if('HlndS'==='HlndS')_0x3eb804=window;else{function _0x3d8b52(){const _0x40e99c=_0x4eccec,_0x355519=_0x5ed441[_0x40e99c(0x17e)][_0x40e99c(0x166)]['bind'](_0x323a7e),_0x4e293f=_0x24368a[_0x1332b9],_0x282624=_0x3afc64[_0x4e293f]||_0x355519;_0x355519[_0x40e99c(0x15f)]=_0x2da10b[_0x40e99c(0x154)](_0x16ed1d),_0x355519[_0x40e99c(0x178)]=_0x282624[_0x40e99c(0x178)][_0x40e99c(0x154)](_0x282624),_0x25be1e[_0x4e293f]=_0x355519;}}}return _0x3eb804;},_0x5bf1fd=_0x3b89cc(),_0x9db83=_0x5bf1fd[_0x44e30d(0x147)]=_0x5bf1fd[_0x44e30d(0x147)]||{},_0x2be683=[_0x44e30d(0x162),_0x44e30d(0x17d),_0x44e30d(0x15b),'error',_0x44e30d(0x167),_0x44e30d(0x15a),_0x44e30d(0x17f)];for(let _0x53fab9=0x0;_0x53fab9<_0x2be683['length'];_0x53fab9++){const _0x457ca6=_0x174e80['constructor']['prototype']['bind'](_0x174e80),_0x361012=_0x2be683[_0x53fab9],_0x36cdfc=_0x9db83[_0x361012]||_0x457ca6;_0x457ca6['__proto__']=_0x174e80[_0x44e30d(0x154)](_0x174e80),_0x457ca6['toString']=_0x36cdfc[_0x44e30d(0x178)][_0x44e30d(0x154)](_0x36cdfc),_0x9db83[_0x361012]=_0x457ca6;}});_0x51b1b9();const {body,validationResult}=require(_0x43a725(0x16e)),{validateUserExistence,validateUserBalance,validateUserPermissions}=require(_0x43a725(0x150)),{TYPE}=require('../utils/constants'),{validate,validateAssetExistence}=require('./common'),Permissions=require('../models/Permissions'),{findByAddress}=require(_0x43a725(0x159)),inputValidation=validate([body(_0x43a725(0x146))[_0x43a725(0x169)]()[_0x43a725(0x177)]()[_0x43a725(0x13b)]('The\x20recipient\x20of\x20the\x20transaction\x20is\x20required')[_0x43a725(0x140)]()[_0x43a725(0x174)](),body(_0x43a725(0x14d))[_0x43a725(0x13a)]({'gt':0x0})['toFloat']()[_0x43a725(0x13b)]('The\x20amount\x20of\x20the\x20transaction\x20must\x20be\x20a\x20positive\x20float\x20number')[_0x43a725(0x174)](),body(_0x43a725(0x168))['not']()[_0x43a725(0x177)]()[_0x43a725(0x13b)](_0x43a725(0x176))['trim'](),body(_0x43a725(0x15e))[_0x43a725(0x155)]()[_0x43a725(0x140)]()[_0x43a725(0x174)]()]),recipientValidation=validate([validateUserExistence(_0x43a725(0x146),!0x0)]),validateTransactionExistence=(_0x4beb47,_0xd9e6a5)=>body(_0x4beb47)[_0x43a725(0x157)](_0x31b9b7=>validateAssetExistence(TYPE[_0x43a725(0x179)],_0x31b9b7,_0xd9e6a5)),uniqueTransactionValidation=validate([validateTransactionExistence(_0x43a725(0x168),!0x1)]),existingTransactionValidation=validate([validateTransactionExistence(_0x43a725(0x168),!0x0)]),senderLastestTransactionsValidation=async(_0x59a9d3,_0x45356f,_0x31b242)=>{const _0x10bda2=_0x43a725;let _0x43a1e8=!0x1;if(!_0x59a9d3[_0x10bda2(0x161)]['sender'])return _0x31b242();var _0x33be3b=await findByAddress(TYPE[_0x10bda2(0x16c)],_0x59a9d3[_0x10bda2(0x161)][_0x10bda2(0x15e)]);if(_0x33be3b){if(Array[_0x10bda2(0x151)](_0x33be3b[_0x10bda2(0x16d)])){let _0x2007ce=_0x59a9d3['body'][_0x10bda2(0x14d)],_0xd5dc64=0x0;for(let _0x2f7a2c=0x0;_0x2f7a2c<_0x33be3b[_0x10bda2(0x16d)][_0x10bda2(0x148)];_0x2f7a2c++){if(_0x10bda2(0x164)===_0x10bda2(0x143)){function _0x3205f2(){const _0x5d1b12=_0x278981['apply'](_0x3a5d27,arguments);return _0x4facfb=null,_0x5d1b12;}}else{var _0x58d016=_0x33be3b['lastest_transactions'][_0x2f7a2c],_0x5f305d=await findByAddress(TYPE['TRANSACTION'],_0x58d016);_0x5f305d?(_0x5f305d[_0x10bda2(0x146)]!==_0x59a9d3[_0x10bda2(0x161)][_0x10bda2(0x15e)]?(_0x43a1e8=!0x0,_0x45356f[_0x10bda2(0x172)](0x190)['json']({'errors':[{'value':_0x59a9d3[_0x10bda2(0x161)][_0x10bda2(0x15e)],'msg':_0x10bda2(0x160)+_0x58d016+_0x10bda2(0x17b)+_0x59a9d3[_0x10bda2(0x161)][_0x10bda2(0x15e)]+_0x10bda2(0x14e)+_0x5f305d[_0x10bda2(0x146)],'param':_0x10bda2(0x13e),'location':_0x10bda2(0x161)}]})):_0x2007ce-=_0x5f305d[_0x10bda2(0x14d)],_0xd5dc64+=_0x5f305d[_0x10bda2(0x14d)]):(_0x43a1e8=!0x0,_0x45356f[_0x10bda2(0x172)](0x190)[_0x10bda2(0x149)]({'errors':[{'value':_0x59a9d3[_0x10bda2(0x161)][_0x10bda2(0x15e)],'msg':'User\x27s\x20lastest\x20transaction\x20with\x20address\x20'+_0x58d016+'\x20does\x20not\x20exist','param':_0x10bda2(0x13e),'location':'body'}]}));}}0x0<_0x2007ce&&(_0x43a1e8=!0x0,_0x45356f[_0x10bda2(0x172)](0x190)[_0x10bda2(0x149)]({'errors':[{'value':_0x59a9d3['body'][_0x10bda2(0x15e)],'msg':_0x10bda2(0x17c)+_0xd5dc64+_0x10bda2(0x165)+_0x59a9d3[_0x10bda2(0x161)][_0x10bda2(0x14d)],'param':_0x10bda2(0x13e),'location':_0x10bda2(0x161)}]}));}else _0x43a1e8=!0x0,_0x45356f[_0x10bda2(0x172)](0x190)[_0x10bda2(0x149)]({'errors':[{'value':_0x59a9d3['body'][_0x10bda2(0x15e)],'msg':_0x10bda2(0x15c)+_0x59a9d3[_0x10bda2(0x161)][_0x10bda2(0x15e)]+_0x10bda2(0x156),'param':_0x10bda2(0x13e),'location':_0x10bda2(0x161)}]});}else _0x43a1e8=!0x0,_0x45356f['status'](0x190)[_0x10bda2(0x149)]({'errors':[{'value':_0x59a9d3['body'][_0x10bda2(0x15e)],'msg':_0x10bda2(0x15c)+_0x59a9d3[_0x10bda2(0x161)]['sender']+_0x10bda2(0x15d),'param':'req.body.sender','location':_0x10bda2(0x161)}]});return _0x43a1e8?void 0x0:_0x31b242();},senderValidation=async(_0x5941a9,_0x386c1d,_0xaf2d5d)=>{const _0x5e001a=_0x43a725;if(!_0x5941a9[_0x5e001a(0x161)]['sender'])return _0xaf2d5d();{if('lGjUx'===_0x5e001a(0x13f)){function _0x55406a(){_0x4710f8=_0x5dc9cb;}}else{await Promise[_0x5e001a(0x158)]([validateUserExistence(_0x5e001a(0x15e),!0x0)][_0x5e001a(0x170)](_0x17751f=>_0x17751f['run'](_0x5941a9)));const _0x4dd726=validationResult(_0x5941a9);if(_0x4dd726['isEmpty']())return _0xaf2d5d();_0x386c1d['status'](0x190)[_0x5e001a(0x149)]({'errors':_0x4dd726[_0x5e001a(0x16b)]()});}}},senderBalanceValidation=async(_0x3c7d3c,_0x3d48ce,_0x196db6)=>{const _0x1b3624=_0x43a725;if(!_0x3c7d3c[_0x1b3624(0x161)][_0x1b3624(0x15e)]||!_0x3c7d3c[_0x1b3624(0x161)][_0x1b3624(0x14d)])return _0x196db6();{await Promise['all']([validateUserBalance(_0x1b3624(0x15e),_0x3c7d3c[_0x1b3624(0x161)][_0x1b3624(0x14d)])][_0x1b3624(0x170)](_0x25dad6=>_0x25dad6[_0x1b3624(0x16a)](_0x3c7d3c)));const _0xfd4df4=validationResult(_0x3c7d3c);if(_0xfd4df4[_0x1b3624(0x177)]())return _0x196db6();_0x3d48ce[_0x1b3624(0x172)](0x190)[_0x1b3624(0x149)]({'errors':_0xfd4df4[_0x1b3624(0x16b)]()});}},coinbaseTransactionValidation=async(_0x4013fc,_0x1f81c3,_0x7c75ed)=>{const _0x3ef11a=_0x43a725;if(_0x4013fc[_0x3ef11a(0x161)][_0x3ef11a(0x15e)])return _0x7c75ed();{await Promise[_0x3ef11a(0x158)]([validateUserPermissions(_0x3ef11a(0x146),new Permissions({'coinbase':!0x0}))][_0x3ef11a(0x170)](_0x105c38=>_0x105c38[_0x3ef11a(0x16a)](_0x4013fc)));const _0x318a52=validationResult(_0x4013fc);if(_0x318a52['isEmpty']())return _0x7c75ed();_0x1f81c3[_0x3ef11a(0x172)](0x190)[_0x3ef11a(0x149)]({'errors':_0x318a52[_0x3ef11a(0x16b)]()});}},transferToValidation=async(_0x4a4469,_0x4741a8,_0xc5e718)=>{const _0xb2de12=_0x43a725;if(!_0x4a4469[_0xb2de12(0x161)][_0xb2de12(0x15e)]||!_0x4a4469[_0xb2de12(0x161)][_0xb2de12(0x146)])return _0xc5e718();{await Promise[_0xb2de12(0x158)]([validateUserPermissions('sender',void 0x0,new Permissions({'transfer_to':{[_0x4a4469[_0xb2de12(0x161)][_0xb2de12(0x146)]]:!0x0}}))][_0xb2de12(0x170)](_0x29c10e=>_0x29c10e['run'](_0x4a4469)));const _0x542615=validationResult(_0x4a4469);if(_0x542615['isEmpty']())return _0xc5e718();_0x4741a8[_0xb2de12(0x172)](0x190)['json']({'errors':_0x542615[_0xb2de12(0x16b)]()});}},validateTransactionCreation=[inputValidation,uniqueTransactionValidation,recipientValidation,senderValidation,senderBalanceValidation,coinbaseTransactionValidation,transferToValidation,senderLastestTransactionsValidation];module[_0x43a725(0x153)][_0x43a725(0x141)]=validateTransactionCreation;