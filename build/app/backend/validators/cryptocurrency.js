const _0x4aef=['bind','User\x27s\x20lastest\x20transaction\x20with\x20address\x20','TRANSACTION','prototype','12365ggWyPY','run','toBoolean','log','withMessage','User\x20with\x20address\x20{','recipient','../models/Permissions',',\x20actual\x20recipient:\x20','lastest_transactions','validateTransactionCreation','../utils/constants','471657JMciMp','AvmRX','}\x20\x20does\x20not\x20exist','all','length','status','isFloat','8LNckKi','{}.constructor(\x22return\x20this\x22)(\x20)','./users','not','630044XrIYSA','custom','params','console','443807yErzmm','GuFuI','__proto__','The\x20amount\x20of\x20the\x20transaction\x20must\x20be\x20a\x20positive\x20float\x20number','aOqRO','Transaction\x20with\x20address\x20','pending','578451jenjFI','bail','sender','body','645585KKtxHI','vhSbo','constructor','signature','The\x20signature\x20of\x20the\x20transaction\x20is\x20required','apply','info','isEmpty','trim','exports','req.body.sender','toString','warn','optional','exception','knPuR','amount','15yqZgbQ','\x20is\x20not\x20pending,\x20thus\x20it\x20cannot\x20be\x20updated','map','true','22556pjELEe','1gswJer','valid','NlGVn','cbzBq','gjemI','json','array','return\x20(function()\x20','\x20does\x20not\x20belong\x20to\x20them.\x20Expected\x20recipient:\x20','../controllers/common',',\x20and\x20the\x20transaction\x20amount\x20is\x20'];const _0x3fde=function(_0x4dce95,_0x68487){_0x4dce95=_0x4dce95-0x13c;let _0x654833=_0x4aef[_0x4dce95];return _0x654833;};const _0x51921a=_0x3fde;(function(_0x405948,_0x196280){const _0x5c3606=_0x3fde;while(!![]){try{const _0x1cca69=parseInt(_0x5c3606(0x14d))+parseInt(_0x5c3606(0x15e))*-parseInt(_0x5c3606(0x172))+parseInt(_0x5c3606(0x142))+-parseInt(_0x5c3606(0x149))+-parseInt(_0x5c3606(0x17e))*-parseInt(_0x5c3606(0x163))+-parseInt(_0x5c3606(0x162))*-parseInt(_0x5c3606(0x185))+-parseInt(_0x5c3606(0x13e));if(_0x1cca69===_0x196280)break;else _0x405948['push'](_0x405948['shift']());}catch(_0x5a86c0){_0x405948['push'](_0x405948['shift']());}}}(_0x4aef,0x54d87));const _0x48338f=function(){let _0x131b90=!![];return function(_0x4accf4,_0x157a29){const _0x57957c=_0x3fde;if(_0x57957c(0x17f)!==_0x57957c(0x17f)){function _0x195904(){const _0x2ee4d2=_0x57957c;let _0xf5936b;try{_0xf5936b=_0x5ac03b('return\x20(function()\x20'+_0x2ee4d2(0x186)+');')();}catch(_0x149b58){_0xf5936b=_0x55f323;}return _0xf5936b;}}else{const _0x5b090d=_0x131b90?function(){const _0x5b322c=_0x57957c;if(_0x5b322c(0x15c)===_0x5b322c(0x15c)){if(_0x157a29){const _0x33449c=_0x157a29[_0x5b322c(0x152)](_0x4accf4,arguments);return _0x157a29=null,_0x33449c;}}else{function _0x59fe5c(){const _0x5be270=_0x5b322c;_0x3b11a5=_0xcbaac6(_0x5be270(0x16a)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}}}:function(){};return _0x131b90=![],_0x5b090d;}};}(),_0x145852=_0x48338f(this,function(){const _0x540922=_0x3fde,_0x39aa21=function(){const _0x2b8ffc=_0x3fde;if(_0x2b8ffc(0x166)!==_0x2b8ffc(0x143)){let _0x48810c;try{_0x48810c=Function(_0x2b8ffc(0x16a)+_0x2b8ffc(0x186)+');')();}catch(_0x1141cd){if('vhSbo'===_0x2b8ffc(0x14e))_0x48810c=window;else{function _0x5396d6(){const _0x722218=_0x22ff16?function(){const _0xbf76e=_0x3fde;if(_0x1eb529){const _0x51429f=_0x5e76c3[_0xbf76e(0x152)](_0x25e77b,arguments);return _0x1c2403=null,_0x51429f;}}:function(){};return _0x2d05c5=![],_0x722218;}}}return _0x48810c;}else{function _0x3f9ed5(){const _0x10167f=_0x2b8ffc,_0x4fcd9d=_0x896111[_0x10167f(0x152)](_0x43e20f,arguments);return _0x133fee=null,_0x4fcd9d;}}},_0x2f78fc=_0x39aa21(),_0x1b5537=_0x2f78fc[_0x540922(0x141)]=_0x2f78fc[_0x540922(0x141)]||{},_0x216f41=[_0x540922(0x175),_0x540922(0x159),_0x540922(0x153),'error',_0x540922(0x15b),'table','trace'];for(let _0x3e430a=0x0;_0x3e430a<_0x216f41[_0x540922(0x182)];_0x3e430a++){if(_0x540922(0x165)!=='MwnRh'){const _0x34453b=_0x48338f['constructor'][_0x540922(0x171)]['bind'](_0x48338f),_0x126f7e=_0x216f41[_0x3e430a],_0x115d3e=_0x1b5537[_0x126f7e]||_0x34453b;_0x34453b[_0x540922(0x144)]=_0x48338f[_0x540922(0x16e)](_0x48338f),_0x34453b[_0x540922(0x158)]=_0x115d3e[_0x540922(0x158)][_0x540922(0x16e)](_0x115d3e),_0x1b5537[_0x126f7e]=_0x34453b;}else{function _0x1bba01(){_0x7ea4c2=_0x569b0f;}}}});_0x145852();const {body,validationResult,matchedData,param}=require('express-validator'),{validateUserExistence,validateUserBalance,validateUserPermissions}=require(_0x51921a(0x13c)),{TYPE}=require(_0x51921a(0x17d)),{validate,validateAssetExistence}=require('./common'),Permissions=require(_0x51921a(0x179)),{findByAddress}=require(_0x51921a(0x16c)),inputValidation=validate([body('recipient')[_0x51921a(0x13d)]()[_0x51921a(0x154)]()[_0x51921a(0x176)]('The\x20recipient\x20of\x20the\x20transaction\x20is\x20required')[_0x51921a(0x155)]()[_0x51921a(0x14a)](),body('amount')[_0x51921a(0x184)]({'gt':0x0})['toFloat']()[_0x51921a(0x176)](_0x51921a(0x145))['bail'](),body(_0x51921a(0x150))[_0x51921a(0x13d)]()['isEmpty']()[_0x51921a(0x176)](_0x51921a(0x151))[_0x51921a(0x155)]()[_0x51921a(0x14a)](),body(_0x51921a(0x14b))[_0x51921a(0x15a)]({'checkFalsy':!0x0,'checkNull':!0x0})[_0x51921a(0x155)](),body(_0x51921a(0x164))['customSanitizer']((_0x544e2,{req:_0x26073e})=>(null===_0x26073e[_0x51921a(0x14c)][_0x51921a(0x148)]||void 0x0===_0x26073e[_0x51921a(0x14c)][_0x51921a(0x148)]||!0x0!==_0x26073e['body'][_0x51921a(0x148)]&&_0x51921a(0x161)!==_0x26073e['body'][_0x51921a(0x148)])&&_0x544e2),body(_0x51921a(0x148))[_0x51921a(0x15a)]({'checkNull':!0x0})['toBoolean'](),body('valid')['optional']({'checkNull':!0x0})[_0x51921a(0x174)]()]),recipientValidation=validate([validateUserExistence(_0x51921a(0x178),!0x0)]),validateTransactionExistence=(_0x24dc53,_0x14717e)=>_0x24dc53[_0x51921a(0x13f)](_0x500439=>validateAssetExistence(TYPE['TRANSACTION'],_0x500439,_0x14717e)),uniqueTransactionValidation=validate([validateTransactionExistence(body(_0x51921a(0x150)),!0x1)]),existingTransactionAddress=validate([validateTransactionExistence(param('address'),!0x0)]),senderLastestTransactionsValidation=async(_0x5e959d,_0x306252,_0x30f95d)=>{const _0x1e7d57=_0x51921a;let _0x3a3618=!0x1;if(_0x5e959d['body'][_0x1e7d57(0x14b)]){var _0x57dada=await findByAddress(TYPE['USER'],_0x5e959d['body'][_0x1e7d57(0x14b)]);if(!_0x57dada)return _0x3a3618=!0x0,_0x306252[_0x1e7d57(0x183)](0x190)['json']({'errors':[{'value':_0x5e959d['body'][_0x1e7d57(0x14b)],'msg':_0x1e7d57(0x177)+_0x5e959d[_0x1e7d57(0x14c)]['sender']+_0x1e7d57(0x180),'param':_0x1e7d57(0x157),'location':_0x1e7d57(0x14c)}]});if(!Array['isArray'](_0x57dada[_0x1e7d57(0x17b)]))return _0x3a3618=!0x0,_0x306252[_0x1e7d57(0x183)](0x190)[_0x1e7d57(0x168)]({'errors':[{'value':_0x5e959d['body'][_0x1e7d57(0x14b)],'msg':_0x1e7d57(0x177)+_0x5e959d['body']['sender']+'}\x20does\x20not\x20have\x20any\x20lastest_transactions','param':'req.body.sender','location':_0x1e7d57(0x14c)}]});let _0x4b1159=_0x5e959d[_0x1e7d57(0x14c)][_0x1e7d57(0x15d)],_0x1c15a0=0x0;for(let _0x185ae7=0x0;_0x185ae7<_0x57dada['lastest_transactions'][_0x1e7d57(0x182)];_0x185ae7+=0x1){var _0x184e69=_0x57dada[_0x1e7d57(0x17b)][_0x185ae7],_0x2daf2c=await findByAddress(TYPE['TRANSACTION'],_0x184e69);if(!_0x2daf2c)return _0x3a3618=!0x0,_0x306252['status'](0x190)[_0x1e7d57(0x168)]({'errors':[{'value':_0x5e959d[_0x1e7d57(0x14c)]['sender'],'msg':_0x1e7d57(0x16f)+_0x184e69+'\x20does\x20not\x20exist','param':_0x1e7d57(0x157),'location':_0x1e7d57(0x14c)}]});if(_0x2daf2c[_0x1e7d57(0x178)]!==_0x5e959d[_0x1e7d57(0x14c)][_0x1e7d57(0x14b)])return _0x3a3618=!0x0,_0x306252['status'](0x190)[_0x1e7d57(0x168)]({'errors':[{'value':_0x5e959d[_0x1e7d57(0x14c)][_0x1e7d57(0x14b)],'msg':_0x1e7d57(0x16f)+_0x184e69+_0x1e7d57(0x16b)+_0x5e959d[_0x1e7d57(0x14c)][_0x1e7d57(0x14b)]+_0x1e7d57(0x17a)+_0x2daf2c['recipient'],'param':'req.body.sender','location':_0x1e7d57(0x14c)}]});_0x4b1159-=_0x2daf2c[_0x1e7d57(0x15d)],_0x1c15a0+=_0x2daf2c[_0x1e7d57(0x15d)];}return 0x0<_0x4b1159?(_0x3a3618=!0x0,_0x306252[_0x1e7d57(0x183)](0x190)[_0x1e7d57(0x168)]({'errors':[{'value':_0x5e959d['body']['sender'],'msg':'Insufficient\x20funds.\x20User\x27s\x20lastest\x20transaction\x20reflect\x20a\x20balance\x20of\x20'+_0x1c15a0+_0x1e7d57(0x16d)+_0x5e959d[_0x1e7d57(0x14c)]['amount'],'param':_0x1e7d57(0x157),'location':_0x1e7d57(0x14c)}]})):_0x3a3618?_0x306252[_0x1e7d57(0x183)](0x190)['json']({'errors':_0x3a3618}):_0x30f95d();}return _0x30f95d();},senderValidation=async(_0x4689ee,_0x425249,_0x5b54a9)=>{const _0xbe421=_0x51921a;if(!_0x4689ee[_0xbe421(0x14c)][_0xbe421(0x14b)])return _0x5b54a9();{await Promise[_0xbe421(0x181)]([validateUserExistence(_0xbe421(0x14b),!0x0)]['map'](_0x232c14=>_0x232c14[_0xbe421(0x173)](_0x4689ee)));const _0x1924f4=validationResult(_0x4689ee);if(_0x1924f4[_0xbe421(0x154)]())return _0x5b54a9();_0x425249['status'](0x190)[_0xbe421(0x168)]({'errors':_0x1924f4[_0xbe421(0x169)]()});}},senderBalanceValidation=async(_0xbc574b,_0x3ae91c,_0x1e7cf3)=>{const _0x51718a=_0x51921a;if(!_0xbc574b[_0x51718a(0x14c)][_0x51718a(0x14b)]||!_0xbc574b[_0x51718a(0x14c)][_0x51718a(0x15d)])return _0x1e7cf3();{if(_0x51718a(0x167)!=='gjemI'){function _0x25993c(){const _0x50221e=_0x51718a,_0x53c27f=_0x399355[_0x50221e(0x14f)][_0x50221e(0x171)][_0x50221e(0x16e)](_0x11c007),_0x5613c4=_0x3140fd[_0xa253f3],_0x3f497b=_0x5e540d[_0x5613c4]||_0x53c27f;_0x53c27f[_0x50221e(0x144)]=_0x1698d7[_0x50221e(0x16e)](_0x689964),_0x53c27f[_0x50221e(0x158)]=_0x3f497b['toString'][_0x50221e(0x16e)](_0x3f497b),_0x51e231[_0x5613c4]=_0x53c27f;}}else{await Promise[_0x51718a(0x181)]([validateUserBalance(_0x51718a(0x14b),_0xbc574b[_0x51718a(0x14c)]['amount'])][_0x51718a(0x160)](_0x143558=>_0x143558[_0x51718a(0x173)](_0xbc574b)));const _0x5068f3=validationResult(_0xbc574b);if(_0x5068f3['isEmpty']())return _0x1e7cf3();_0x3ae91c[_0x51718a(0x183)](0x190)[_0x51718a(0x168)]({'errors':_0x5068f3[_0x51718a(0x169)]()});}}},coinbaseTransactionValidation=async(_0x35f3db,_0x4220cb,_0x5232e5)=>{const _0x4a6cff=_0x51921a;if(_0x35f3db[_0x4a6cff(0x14c)][_0x4a6cff(0x14b)])return _0x5232e5();{if('aOqRO'===_0x4a6cff(0x146)){await Promise[_0x4a6cff(0x181)]([validateUserPermissions(_0x4a6cff(0x178),new Permissions({'coinbase':!0x0}))][_0x4a6cff(0x160)](_0x3a3145=>_0x3a3145[_0x4a6cff(0x173)](_0x35f3db)));const _0x5487bf=validationResult(_0x35f3db);if(_0x5487bf[_0x4a6cff(0x154)]())return _0x5232e5();_0x4220cb[_0x4a6cff(0x183)](0x190)['json']({'errors':_0x5487bf[_0x4a6cff(0x169)]()});}else{function _0x2e275a(){if(_0xd6be95){const _0x5c098a=_0x54ba55['apply'](_0x2f9ad9,arguments);return _0x1304ba=null,_0x5c098a;}}}}},transferToValidation=async(_0x4c3b5a,_0x3f3ff8,_0x38a275)=>{const _0x368e9f=_0x51921a;if(!_0x4c3b5a[_0x368e9f(0x14c)][_0x368e9f(0x14b)]||!_0x4c3b5a[_0x368e9f(0x14c)][_0x368e9f(0x178)])return _0x38a275();{await Promise[_0x368e9f(0x181)]([validateUserPermissions('sender',void 0x0,new Permissions({'transfer_to':{[_0x4c3b5a[_0x368e9f(0x14c)]['recipient']]:!0x0}}))]['map'](_0x3a14d3=>_0x3a14d3[_0x368e9f(0x173)](_0x4c3b5a)));const _0x3b72c8=validationResult(_0x4c3b5a);if(_0x3b72c8[_0x368e9f(0x154)]())return _0x38a275();_0x3f3ff8['status'](0x190)[_0x368e9f(0x168)]({'errors':_0x3b72c8[_0x368e9f(0x169)]()});}},validatePendingTransaction=async(_0xed6eee,_0xaf6b91,_0x468c1c)=>{const _0x305bc7=_0x51921a;var {address:_0xed6eee}=_0xed6eee[_0x305bc7(0x140)];return(await findByAddress(TYPE[_0x305bc7(0x170)],_0xed6eee))[_0x305bc7(0x148)]?_0x468c1c():_0xaf6b91[_0x305bc7(0x183)](0x190)['json']({'errors':[{'value':_0xed6eee,'msg':_0x305bc7(0x147)+_0xed6eee+_0x305bc7(0x15f),'param':'req.params.address','location':_0x305bc7(0x140)}]});},validateTransactionCreation=[inputValidation,uniqueTransactionValidation,recipientValidation,senderValidation,senderBalanceValidation,coinbaseTransactionValidation,transferToValidation,senderLastestTransactionsValidation],validateTransactionAddress=[existingTransactionAddress],validateTransactionUpdateRequest=[validatePendingTransaction];module[_0x51921a(0x156)][_0x51921a(0x17c)]=validateTransactionCreation,module[_0x51921a(0x156)]['validateTransactionAddress']=validateTransactionAddress,module[_0x51921a(0x156)]['validateTransactionUpdateRequest']=validateTransactionUpdateRequest;