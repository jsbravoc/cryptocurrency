const _0x2929=['../controllers/common','optional','55SKfzWk','{}.constructor(\x22return\x20this\x22)(\x20)','body','2611iwFFye','validateTransactionUpdateRequest','The\x20amount\x20of\x20the\x20transaction\x20must\x20be\x20a\x20positive\x20float\x20number','\x20does\x20not\x20belong\x20to\x20them.\x20Expected\x20recipient:\x20','warn','exception','params','valid','custom','req.params.address','../models/Permissions','bind','run','The\x20signature\x20of\x20the\x20transaction\x20is\x20required','apply','wHEAg','User\x27s\x20lastest\x20transaction\x20with\x20address\x20','FJaAb',',\x20actual\x20recipient:\x20',',\x20and\x20the\x20transaction\x20amount\x20is\x20','isArray','isEmpty','toString','constructor','all','withMessage','status','log','143JmgIFC','__proto__','./common','json','length','trace','../utils/constants','true','bail','VeABi','dzsCS','trim','245818GdHYhj','494235LepgHh','exports','customSanitizer','\x20does\x20not\x20exist','pending','info','toBoolean','map','error','USER','array','return\x20(function()\x20','335KsInDQ','4DzGqXg','signature','The\x20recipient\x20of\x20the\x20transaction\x20is\x20required','243841iaMAmH','console','117336jQXhvy','req.body.sender','sender','prototype','amount','not','lastest_transactions','recipient','express-validator','13259rRmVGc','table','TRANSACTION','\x20is\x20not\x20pending,\x20thus\x20it\x20cannot\x20be\x20updated','novjc'];const _0x1345=function(_0x4cc281,_0x5cb743){_0x4cc281=_0x4cc281-0x1c0;let _0x4e2974=_0x2929[_0x4cc281];return _0x4e2974;};const _0x55d10f=_0x1345;(function(_0x4fc1a5,_0x186d52){const _0x269343=_0x1345;while(!![]){try{const _0x9d85df=-parseInt(_0x269343(0x207))+parseInt(_0x269343(0x1d5))*-parseInt(_0x269343(0x1c7))+parseInt(_0x269343(0x1ca))+-parseInt(_0x269343(0x1cc))+-parseInt(_0x269343(0x1df))*parseInt(_0x269343(0x1dc))+-parseInt(_0x269343(0x1c6))*-parseInt(_0x269343(0x1fb))+parseInt(_0x269343(0x208));if(_0x9d85df===_0x186d52)break;else _0x4fc1a5['push'](_0x4fc1a5['shift']());}catch(_0x38619f){_0x4fc1a5['push'](_0x4fc1a5['shift']());}}}(_0x2929,0x3738a));const _0x1b21fc=function(){let _0x3bc292=!![];return function(_0x32c5c5,_0x3c5b2d){const _0x927f19=_0x3bc292?function(){const _0x3cec70=_0x1345;if(_0x3cec70(0x1ee)!==_0x3cec70(0x1ee)){function _0x90fe73(){const _0xc72f93=_0x3cec70;let _0x585dc0;try{const _0x5734ee=_0x5938e4('return\x20(function()\x20'+_0xc72f93(0x1dd)+');');_0x585dc0=_0x5734ee();}catch(_0x46e945){_0x585dc0=_0x158633;}const _0x31c067=_0x585dc0[_0xc72f93(0x1cb)]=_0x585dc0[_0xc72f93(0x1cb)]||{},_0x5b0f81=[_0xc72f93(0x1fa),_0xc72f93(0x1e3),'info',_0xc72f93(0x1c2),_0xc72f93(0x1e4),_0xc72f93(0x1d6),_0xc72f93(0x200)];for(let _0x401fad=0x0;_0x401fad<_0x5b0f81['length'];_0x401fad++){const _0x7ceb13=_0x14a1b1['constructor'][_0xc72f93(0x1cf)]['bind'](_0x5ac469),_0xc9917a=_0x5b0f81[_0x401fad],_0x1676eb=_0x31c067[_0xc9917a]||_0x7ceb13;_0x7ceb13['__proto__']=_0x264e1b[_0xc72f93(0x1ea)](_0x545413),_0x7ceb13[_0xc72f93(0x1f5)]=_0x1676eb[_0xc72f93(0x1f5)][_0xc72f93(0x1ea)](_0x1676eb),_0x31c067[_0xc9917a]=_0x7ceb13;}}}else{if(_0x3c5b2d){const _0x48795d=_0x3c5b2d['apply'](_0x32c5c5,arguments);return _0x3c5b2d=null,_0x48795d;}}}:function(){};return _0x3bc292=![],_0x927f19;};}(),_0x48934c=_0x1b21fc(this,function(){const _0x178831=_0x1345;let _0x54b0c5;try{if(_0x178831(0x1d9)==='VPrmV'){function _0x1b70bd(){const _0x10f39b=_0x55db9b?function(){const _0xf70995=_0x1345;if(_0x4360fd){const _0x2a0b14=_0x50848d[_0xf70995(0x1ed)](_0x4856f4,arguments);return _0x3f47f5=null,_0x2a0b14;}}:function(){};return _0x3cc98a=![],_0x10f39b;}}else{const _0x352b47=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x54b0c5=_0x352b47();}}catch(_0x5748b6){_0x54b0c5=window;}const _0x27c382=_0x54b0c5[_0x178831(0x1cb)]=_0x54b0c5[_0x178831(0x1cb)]||{},_0x458e11=['log','warn',_0x178831(0x20d),_0x178831(0x1c2),_0x178831(0x1e4),_0x178831(0x1d6),_0x178831(0x200)];for(let _0x1aef80=0x0;_0x1aef80<_0x458e11[_0x178831(0x1ff)];_0x1aef80++){if(_0x178831(0x204)===_0x178831(0x204)){const _0x491e09=_0x1b21fc[_0x178831(0x1f6)]['prototype'][_0x178831(0x1ea)](_0x1b21fc),_0x5917a1=_0x458e11[_0x1aef80],_0x400eee=_0x27c382[_0x5917a1]||_0x491e09;_0x491e09[_0x178831(0x1fc)]=_0x1b21fc[_0x178831(0x1ea)](_0x1b21fc),_0x491e09[_0x178831(0x1f5)]=_0x400eee[_0x178831(0x1f5)]['bind'](_0x400eee),_0x27c382[_0x5917a1]=_0x491e09;}else{function _0xc3e357(){const _0x1f447a=_0x178831,_0x149146=_0x3a99e8(_0x1f447a(0x1c5)+_0x1f447a(0x1dd)+');');_0x4d8fcb=_0x149146();}}}});_0x48934c();const {body,validationResult,matchedData,param}=require(_0x55d10f(0x1d4)),{validateUserExistence,validateUserBalance,validateUserPermissions}=require('./users'),{TYPE}=require(_0x55d10f(0x201)),{validate,validateAssetExistence}=require(_0x55d10f(0x1fd)),Permissions=require(_0x55d10f(0x1e9)),{findByAddress}=require(_0x55d10f(0x1da)),inputValidation=validate([body(_0x55d10f(0x1d3))[_0x55d10f(0x1d1)]()['isEmpty']()[_0x55d10f(0x1f8)](_0x55d10f(0x1c9))['trim']()[_0x55d10f(0x203)](),body(_0x55d10f(0x1d0))['isFloat']({'gt':0x0})['toFloat']()[_0x55d10f(0x1f8)](_0x55d10f(0x1e1))[_0x55d10f(0x203)](),body(_0x55d10f(0x1c8))['not']()[_0x55d10f(0x1f4)]()[_0x55d10f(0x1f8)](_0x55d10f(0x1ec))[_0x55d10f(0x206)]()[_0x55d10f(0x203)](),body(_0x55d10f(0x1ce))[_0x55d10f(0x1db)]({'checkFalsy':!0x0,'checkNull':!0x0})[_0x55d10f(0x206)](),body(_0x55d10f(0x1e6))[_0x55d10f(0x20a)]((_0x19bbf7,{req:_0x195627})=>(null===_0x195627['body']['pending']||void 0x0===_0x195627[_0x55d10f(0x1de)][_0x55d10f(0x20c)]||!0x0!==_0x195627['body'][_0x55d10f(0x20c)]&&_0x55d10f(0x202)!==_0x195627[_0x55d10f(0x1de)][_0x55d10f(0x20c)])&&_0x19bbf7),body(_0x55d10f(0x20c))[_0x55d10f(0x1db)]({'checkNull':!0x0})[_0x55d10f(0x1c0)](),body('valid')[_0x55d10f(0x1db)]({'checkNull':!0x0})['toBoolean']()]),recipientValidation=validate([validateUserExistence(_0x55d10f(0x1d3),!0x0)]),validateTransactionExistence=(_0x307cd0,_0x5e0ff7)=>_0x307cd0[_0x55d10f(0x1e7)](_0x4619c7=>validateAssetExistence(TYPE[_0x55d10f(0x1d7)],_0x4619c7,_0x5e0ff7)),uniqueTransactionValidation=validate([validateTransactionExistence(body(_0x55d10f(0x1c8)),!0x1)]),existingTransactionAddress=validate([validateTransactionExistence(param('address'),!0x0)]),senderLastestTransactionsValidation=async(_0x3c4475,_0x39d87b,_0x3fad0b)=>{const _0x5ede4d=_0x55d10f;let _0x3d49a6=!0x1;if(_0x3c4475['body'][_0x5ede4d(0x1ce)]){if(_0x5ede4d(0x1f0)===_0x5ede4d(0x205)){function _0x368d6e(){_0x4c22d5=_0x3d6632;}}else{var _0x5433f8=await findByAddress(TYPE[_0x5ede4d(0x1c3)],_0x3c4475[_0x5ede4d(0x1de)][_0x5ede4d(0x1ce)]);if(!_0x5433f8)return _0x3d49a6=!0x0,_0x39d87b[_0x5ede4d(0x1f9)](0x190)['json']({'errors':[{'value':_0x3c4475[_0x5ede4d(0x1de)]['sender'],'msg':'User\x20with\x20address\x20{'+_0x3c4475[_0x5ede4d(0x1de)][_0x5ede4d(0x1ce)]+'}\x20\x20does\x20not\x20exist','param':_0x5ede4d(0x1cd),'location':'body'}]});if(!Array[_0x5ede4d(0x1f3)](_0x5433f8[_0x5ede4d(0x1d2)]))return _0x3d49a6=!0x0,_0x39d87b[_0x5ede4d(0x1f9)](0x190)[_0x5ede4d(0x1fe)]({'errors':[{'value':_0x3c4475[_0x5ede4d(0x1de)][_0x5ede4d(0x1ce)],'msg':'User\x20with\x20address\x20{'+_0x3c4475['body'][_0x5ede4d(0x1ce)]+'}\x20does\x20not\x20have\x20any\x20lastest_transactions','param':_0x5ede4d(0x1cd),'location':_0x5ede4d(0x1de)}]});let _0x4870ea=_0x3c4475[_0x5ede4d(0x1de)][_0x5ede4d(0x1d0)],_0x3a665a=0x0;for(let _0x4fcd57=0x0;_0x4fcd57<_0x5433f8[_0x5ede4d(0x1d2)][_0x5ede4d(0x1ff)];_0x4fcd57+=0x1){if('zjrVc'==='zjrVc'){var _0x575340=_0x5433f8['lastest_transactions'][_0x4fcd57],_0x20663c=await findByAddress(TYPE[_0x5ede4d(0x1d7)],_0x575340);if(!_0x20663c)return _0x3d49a6=!0x0,_0x39d87b[_0x5ede4d(0x1f9)](0x190)['json']({'errors':[{'value':_0x3c4475[_0x5ede4d(0x1de)][_0x5ede4d(0x1ce)],'msg':_0x5ede4d(0x1ef)+_0x575340+_0x5ede4d(0x20b),'param':_0x5ede4d(0x1cd),'location':_0x5ede4d(0x1de)}]});if(_0x20663c['recipient']!==_0x3c4475['body']['sender'])return _0x3d49a6=!0x0,_0x39d87b[_0x5ede4d(0x1f9)](0x190)[_0x5ede4d(0x1fe)]({'errors':[{'value':_0x3c4475['body'][_0x5ede4d(0x1ce)],'msg':_0x5ede4d(0x1ef)+_0x575340+_0x5ede4d(0x1e2)+_0x3c4475['body'][_0x5ede4d(0x1ce)]+_0x5ede4d(0x1f1)+_0x20663c[_0x5ede4d(0x1d3)],'param':_0x5ede4d(0x1cd),'location':_0x5ede4d(0x1de)}]});_0x4870ea-=_0x20663c['amount'],_0x3a665a+=_0x20663c[_0x5ede4d(0x1d0)];}else{function _0x23f3b2(){const _0x1750eb=_0x5ede4d,_0xdb05ea=_0x36e640[_0x1750eb(0x1ed)](_0x367da9,arguments);return _0x848036=null,_0xdb05ea;}}}return 0x0<_0x4870ea?(_0x3d49a6=!0x0,_0x39d87b['status'](0x190)[_0x5ede4d(0x1fe)]({'errors':[{'value':_0x3c4475[_0x5ede4d(0x1de)][_0x5ede4d(0x1ce)],'msg':'Insufficient\x20funds.\x20User\x27s\x20lastest\x20transaction\x20reflect\x20a\x20balance\x20of\x20'+_0x3a665a+_0x5ede4d(0x1f2)+_0x3c4475[_0x5ede4d(0x1de)][_0x5ede4d(0x1d0)],'param':'req.body.sender','location':'body'}]})):_0x3d49a6?_0x39d87b[_0x5ede4d(0x1f9)](0x190)[_0x5ede4d(0x1fe)]({'errors':_0x3d49a6}):_0x3fad0b();}}return _0x3fad0b();},senderValidation=async(_0x18421a,_0x178f1b,_0x5495e0)=>{const _0x40a9e2=_0x55d10f;if(!_0x18421a[_0x40a9e2(0x1de)][_0x40a9e2(0x1ce)])return _0x5495e0();{await Promise[_0x40a9e2(0x1f7)]([validateUserExistence(_0x40a9e2(0x1ce),!0x0)][_0x40a9e2(0x1c1)](_0x3ac036=>_0x3ac036['run'](_0x18421a)));const _0x258cd5=validationResult(_0x18421a);if(_0x258cd5['isEmpty']())return _0x5495e0();_0x178f1b[_0x40a9e2(0x1f9)](0x190)[_0x40a9e2(0x1fe)]({'errors':_0x258cd5[_0x40a9e2(0x1c4)]()});}},senderBalanceValidation=async(_0x360386,_0x14c9ff,_0x11ab22)=>{const _0x2f1984=_0x55d10f;if(!_0x360386[_0x2f1984(0x1de)][_0x2f1984(0x1ce)]||!_0x360386[_0x2f1984(0x1de)][_0x2f1984(0x1d0)])return _0x11ab22();{await Promise['all']([validateUserBalance(_0x2f1984(0x1ce),_0x360386[_0x2f1984(0x1de)][_0x2f1984(0x1d0)])][_0x2f1984(0x1c1)](_0x474bef=>_0x474bef[_0x2f1984(0x1eb)](_0x360386)));const _0x3dfdec=validationResult(_0x360386);if(_0x3dfdec[_0x2f1984(0x1f4)]())return _0x11ab22();_0x14c9ff['status'](0x190)['json']({'errors':_0x3dfdec[_0x2f1984(0x1c4)]()});}},coinbaseTransactionValidation=async(_0x54c680,_0x361522,_0x5d4274)=>{const _0x44d8f2=_0x55d10f;if(_0x54c680[_0x44d8f2(0x1de)][_0x44d8f2(0x1ce)])return _0x5d4274();{await Promise[_0x44d8f2(0x1f7)]([validateUserPermissions(_0x44d8f2(0x1d3),new Permissions({'coinbase':!0x0}))][_0x44d8f2(0x1c1)](_0x1e6f2b=>_0x1e6f2b[_0x44d8f2(0x1eb)](_0x54c680)));const _0x77fddc=validationResult(_0x54c680);if(_0x77fddc['isEmpty']())return _0x5d4274();_0x361522[_0x44d8f2(0x1f9)](0x190)[_0x44d8f2(0x1fe)]({'errors':_0x77fddc[_0x44d8f2(0x1c4)]()});}},transferToValidation=async(_0x14514a,_0x510d38,_0x425d82)=>{const _0x1861a9=_0x55d10f;if(!_0x14514a[_0x1861a9(0x1de)][_0x1861a9(0x1ce)]||!_0x14514a[_0x1861a9(0x1de)][_0x1861a9(0x1d3)])return _0x425d82();{await Promise[_0x1861a9(0x1f7)]([validateUserPermissions(_0x1861a9(0x1ce),void 0x0,new Permissions({'transfer_to':{[_0x14514a['body']['recipient']]:!0x0}}))][_0x1861a9(0x1c1)](_0x4d62fb=>_0x4d62fb[_0x1861a9(0x1eb)](_0x14514a)));const _0x20e362=validationResult(_0x14514a);if(_0x20e362['isEmpty']())return _0x425d82();_0x510d38[_0x1861a9(0x1f9)](0x190)[_0x1861a9(0x1fe)]({'errors':_0x20e362[_0x1861a9(0x1c4)]()});}},validatePendingTransaction=async(_0xd32c38,_0x7be373,_0x2ee0b7)=>{const _0x23a9ec=_0x55d10f;var {address:_0xd32c38}=_0xd32c38['params'];return(await findByAddress(TYPE[_0x23a9ec(0x1d7)],_0xd32c38))[_0x23a9ec(0x20c)]?_0x2ee0b7():_0x7be373[_0x23a9ec(0x1f9)](0x190)[_0x23a9ec(0x1fe)]({'errors':[{'value':_0xd32c38,'msg':'Transaction\x20with\x20address\x20'+_0xd32c38+_0x23a9ec(0x1d8),'param':_0x23a9ec(0x1e8),'location':_0x23a9ec(0x1e5)}]});},validateTransactionCreation=[inputValidation,uniqueTransactionValidation,recipientValidation,senderValidation,senderBalanceValidation,coinbaseTransactionValidation,transferToValidation,senderLastestTransactionsValidation],validateTransactionAddress=[existingTransactionAddress],validateTransactionUpdateRequest=[validatePendingTransaction];module[_0x55d10f(0x209)]['validateTransactionCreation']=validateTransactionCreation,module[_0x55d10f(0x209)]['validateTransactionAddress']=validateTransactionAddress,module[_0x55d10f(0x209)][_0x55d10f(0x1e0)]=validateTransactionUpdateRequest;