/*! cryptocurrency 2021-05-10 */
let tpProcess,dockerProcess,backendProcess;const{spawn}=require("child_process"),kill=require("tree-kill"),shell=require("shelljs");exports.mochaHooks={beforeAll:function(e){this.timeout(3e4),setTimeout(e,6e3)},beforeAllBk:function(e){this.timeout(3e4),tpProcess=shell.exec("npm --prefix ../transaction_processor run start",{async:!0,silent:!0}),dockerProcess=shell.exec("docker-compose -f ../../../blockchain_network/docker-compose-dev/sawtooth/docker-compose.yaml up",{async:!0,silent:!0}),setTimeout(()=>{backendProcess=shell.exec("npm run start",{async:!0,silent:!0})},2e4),setTimeout(()=>{e()},25e3)},afterAllBk:function(e){try{kill(dockerProcess.pid),kill(tpProcess.pid),kill(backendProcess.pid)}catch(e){console.log(e)}spawn("gnome-terminal",["--disable-factory","--","bash -c 'docker-compose -f ../../../blockchain_network/docker-compose-dev/sawtooth/docker-compose.yaml down;exec bash'"],{detached:!0,shell:!0}),spawn("gnome-terminal",["--disable-factory","--",`bash -c 'sudo kill -9 $(sudo lsof -t -i:${process.env.PORT||"3000"})'`],{detached:!0,shell:!0}),e()}};