const{TYPE}=require("../utils/constants"),BaseModel=require("./BaseModel");class Transaction extends BaseModel{constructor({amount:t,recipient:i,address:s,sender:n,description:r,valid:e=!0,valid_thru:a,signature:o,supporting_transactions:u,pending:c,creationDate:h=new Date,creator:p}){super(TYPE.TRANSACTION,s),this.amount=t,this.recipient=i,this.signature=o,this.creationDate=h,this.valid=null==e||e,this.creator=p||n||i,null!=n&&(this.sender=n),null!=r&&(this.description=r),null!=a&&(this.valid_thru=new Date(a)),null!=c&&(this.pending=c),null!=u&&(this.supporting_transactions=u)}checkValidity(){return!(this.valid_thru&&new Date(this.valid_thru)<new Date)}toSignatureObject(){var{amount:t,recipient:i,sender:s,creator:n}=this,n={amount:t,recipient:i,sender:s,creator:n};return Transaction.toSortedObject(n)}toSignatureString(){return JSON.stringify(this.toSignatureObject())}addSupportingTransaction(t){this.supporting_transactions&&Array.isArray(this.supporting_transactions)||(this.supporting_transactions=[]),this.supporting_transactions.push(t)}toSimplifiedObject(){const t={address:this.address,recipient:this.recipient};return this.sender&&(t.sender=this.sender),t.amount=this.amount,t.signature=this.signature,this.supporting_transactions&&(t.supporting_transactions=this.supporting_transactions.length),t}}module.exports=Transaction;