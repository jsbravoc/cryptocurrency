const{TYPE}=require("../utils/constants"),BaseModel=require("./BaseModel");class Transaction extends BaseModel{constructor({amount:t,recipient:i,address:n,sender:r,description:s,valid:e=!0,valid_thru:a,signature:o,supporting_transactions:u,pending:c,creationDate:d=new Date,creator:h,txid:l}){super(TYPE.TRANSACTION,n),this.amount=t,this.recipient=i,this.signature=o||l,this.creationDate=d,this.valid=null==e||e,this.creator=h||r||i,null!=r&&(this.sender=r),null!=s&&(this.description=s),null!=a&&(this.valid_thru=new Date(a)),null!=c&&(this.pending=c),null!=u&&(this.supporting_transactions=u)}checkValidity(){return!(this.valid_thru&&new Date(this.valid_thru)<new Date)}toSignatureObject(){var{amount:t,recipient:i,sender:n,creator:r}=this,r={amount:t,recipient:i,sender:n,creator:r};return Transaction.toSortedObject(r)}toSignatureString(){return JSON.stringify(this.toSignatureObject())}addSupportingTransaction(t){this.supporting_transactions&&Array.isArray(this.supporting_transactions)||(this.supporting_transactions=[]),this.supporting_transactions.push(t)}}module.exports=Transaction;